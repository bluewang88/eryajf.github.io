<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Jenkinsfileå£°æ˜å¼è¯­æ³•è¯¦è§£ | äºŒä¸«è®²æ¢µ</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <script language="javascript" type="text/javascript" src="/js/pgmanor-self.js"></script>
    <meta name="description" content="ğŸ’»å­¦ä¹ ğŸ“è®°å½•ğŸ”—åˆ†äº«
å­¦æ— æ­¢å¢ƒæ˜¯æ°¸è¿œå‰è¿›çš„åŸºç¡€ï¼Œè·ƒç„¶çº¸ä¸Šæ˜¯å¯¹çŸ¥è¯†çš„æ€»ç»“äº¤ä»£ï¼Œä¸ä¼—åˆ†äº«åˆ™æ˜¯å®ç°ä»·å€¼çš„æœ€å¥½æ–¹å¼ã€‚">
    <meta name="keywords" content="äºŒä¸«è®²æ¢µ,Linux,è¿ç»´,yum,è¿ç»´è‰ºæœ¯,eryajf,jenkins,nexus,golang,vue">
    <meta name="baidu-site-verification" content="code-LTKHwOecxI">
    <meta name="theme-color" content="#11a8cd">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="preload" href="/assets/css/0.styles.bab6b875.css" as="style"><link rel="preload" href="/assets/js/app.8ad1afb9.js" as="script"><link rel="preload" href="/assets/js/2.faffa19e.js" as="script"><link rel="preload" href="/assets/js/210.55c9cde7.js" as="script"><link rel="prefetch" href="/assets/js/10.8b9230dd.js"><link rel="prefetch" href="/assets/js/100.6c13a023.js"><link rel="prefetch" href="/assets/js/101.3c3868ff.js"><link rel="prefetch" href="/assets/js/102.b4936732.js"><link rel="prefetch" href="/assets/js/103.a10d22d6.js"><link rel="prefetch" href="/assets/js/104.827e2d15.js"><link rel="prefetch" href="/assets/js/105.fc3ad64a.js"><link rel="prefetch" href="/assets/js/106.b98a5fa3.js"><link rel="prefetch" href="/assets/js/107.892ca7be.js"><link rel="prefetch" href="/assets/js/108.474705f8.js"><link rel="prefetch" href="/assets/js/109.3fb3b9dd.js"><link rel="prefetch" href="/assets/js/11.506bc27a.js"><link rel="prefetch" href="/assets/js/110.254e8639.js"><link rel="prefetch" href="/assets/js/111.6ff39a82.js"><link rel="prefetch" href="/assets/js/112.092ef7d0.js"><link rel="prefetch" href="/assets/js/113.1411d60d.js"><link rel="prefetch" href="/assets/js/114.f7bbe30e.js"><link rel="prefetch" href="/assets/js/115.fd7676e5.js"><link rel="prefetch" href="/assets/js/116.d4e0ce88.js"><link rel="prefetch" href="/assets/js/117.8507ca3d.js"><link rel="prefetch" href="/assets/js/118.a7502430.js"><link rel="prefetch" href="/assets/js/119.1f3aadb9.js"><link rel="prefetch" href="/assets/js/12.c6a09fa9.js"><link rel="prefetch" href="/assets/js/120.d5fddbd2.js"><link rel="prefetch" href="/assets/js/121.3c16499f.js"><link rel="prefetch" href="/assets/js/122.60a09550.js"><link rel="prefetch" href="/assets/js/123.39d9a84e.js"><link rel="prefetch" href="/assets/js/124.d72864d6.js"><link rel="prefetch" href="/assets/js/125.5799a31b.js"><link rel="prefetch" href="/assets/js/126.ba2f3ce1.js"><link rel="prefetch" href="/assets/js/127.0720f31e.js"><link rel="prefetch" href="/assets/js/128.dbd72e9d.js"><link rel="prefetch" href="/assets/js/129.5a812166.js"><link rel="prefetch" href="/assets/js/13.23769307.js"><link rel="prefetch" href="/assets/js/130.85d4be67.js"><link rel="prefetch" href="/assets/js/131.95df4386.js"><link rel="prefetch" href="/assets/js/132.566bbcd1.js"><link rel="prefetch" href="/assets/js/133.957a6668.js"><link rel="prefetch" href="/assets/js/134.52b50f4c.js"><link rel="prefetch" href="/assets/js/135.21bcaa67.js"><link rel="prefetch" href="/assets/js/136.371429d5.js"><link rel="prefetch" href="/assets/js/137.5cd82748.js"><link rel="prefetch" href="/assets/js/138.032dbdcf.js"><link rel="prefetch" href="/assets/js/139.7085744f.js"><link rel="prefetch" href="/assets/js/14.0651b524.js"><link rel="prefetch" href="/assets/js/140.e3a4e607.js"><link rel="prefetch" href="/assets/js/141.4f81b731.js"><link rel="prefetch" href="/assets/js/142.94e8234c.js"><link rel="prefetch" href="/assets/js/143.7372ed24.js"><link rel="prefetch" href="/assets/js/144.a75cda5c.js"><link rel="prefetch" href="/assets/js/145.d93b5dee.js"><link rel="prefetch" href="/assets/js/146.74064f66.js"><link rel="prefetch" href="/assets/js/147.1fc01380.js"><link rel="prefetch" href="/assets/js/148.9d073da1.js"><link rel="prefetch" href="/assets/js/149.b7d09403.js"><link rel="prefetch" href="/assets/js/15.4417812d.js"><link rel="prefetch" href="/assets/js/150.19389b91.js"><link rel="prefetch" href="/assets/js/151.85ba9bb2.js"><link rel="prefetch" href="/assets/js/152.102d5a41.js"><link rel="prefetch" href="/assets/js/153.564fd6b9.js"><link rel="prefetch" href="/assets/js/154.4dcb4aa3.js"><link rel="prefetch" href="/assets/js/155.9a12803c.js"><link rel="prefetch" href="/assets/js/156.83565820.js"><link rel="prefetch" href="/assets/js/157.120a42fa.js"><link rel="prefetch" href="/assets/js/158.c424d6f9.js"><link rel="prefetch" href="/assets/js/159.1f8d7551.js"><link rel="prefetch" href="/assets/js/16.2ea73ea1.js"><link rel="prefetch" href="/assets/js/160.10aceb47.js"><link rel="prefetch" href="/assets/js/161.28f4a914.js"><link rel="prefetch" href="/assets/js/162.0fdb95d3.js"><link rel="prefetch" href="/assets/js/163.5570b1f7.js"><link rel="prefetch" href="/assets/js/164.ddfbf05f.js"><link rel="prefetch" href="/assets/js/165.799bade0.js"><link rel="prefetch" href="/assets/js/166.540dfdce.js"><link rel="prefetch" href="/assets/js/167.5224ceb3.js"><link rel="prefetch" href="/assets/js/168.02c735a4.js"><link rel="prefetch" href="/assets/js/169.050e61e6.js"><link rel="prefetch" href="/assets/js/17.8627c85a.js"><link rel="prefetch" href="/assets/js/170.c4a350f7.js"><link rel="prefetch" href="/assets/js/171.bd2edec8.js"><link rel="prefetch" href="/assets/js/172.23937d39.js"><link rel="prefetch" href="/assets/js/173.7d0a69ac.js"><link rel="prefetch" href="/assets/js/174.30d3bce6.js"><link rel="prefetch" href="/assets/js/175.b9d4a87a.js"><link rel="prefetch" href="/assets/js/176.337cb377.js"><link rel="prefetch" href="/assets/js/177.6eddd411.js"><link rel="prefetch" href="/assets/js/178.1ec760f9.js"><link rel="prefetch" href="/assets/js/179.18836caf.js"><link rel="prefetch" href="/assets/js/18.fa4dcbd6.js"><link rel="prefetch" href="/assets/js/180.1773da8a.js"><link rel="prefetch" href="/assets/js/181.42ef98cd.js"><link rel="prefetch" href="/assets/js/182.7a6c4bec.js"><link rel="prefetch" href="/assets/js/183.b93c7ce0.js"><link rel="prefetch" href="/assets/js/184.448d3a2e.js"><link rel="prefetch" href="/assets/js/185.558b843a.js"><link rel="prefetch" href="/assets/js/186.5cfc316a.js"><link rel="prefetch" href="/assets/js/187.83c762d9.js"><link rel="prefetch" href="/assets/js/188.a3e54335.js"><link rel="prefetch" href="/assets/js/189.b039fb36.js"><link rel="prefetch" href="/assets/js/19.5b9c174c.js"><link rel="prefetch" href="/assets/js/190.d8bc3b1c.js"><link rel="prefetch" href="/assets/js/191.d4902385.js"><link rel="prefetch" href="/assets/js/192.d531e154.js"><link rel="prefetch" href="/assets/js/193.2930896b.js"><link rel="prefetch" href="/assets/js/194.7bd72854.js"><link rel="prefetch" href="/assets/js/195.3792c78b.js"><link rel="prefetch" href="/assets/js/196.3ad4444c.js"><link rel="prefetch" href="/assets/js/197.127419b3.js"><link rel="prefetch" href="/assets/js/198.17c2e0e8.js"><link rel="prefetch" href="/assets/js/199.7a8d3a17.js"><link rel="prefetch" href="/assets/js/20.f8ca7cd7.js"><link rel="prefetch" href="/assets/js/200.66a96bdc.js"><link rel="prefetch" href="/assets/js/201.1235f781.js"><link rel="prefetch" href="/assets/js/202.e9a7de3a.js"><link rel="prefetch" href="/assets/js/203.1327e310.js"><link rel="prefetch" href="/assets/js/204.c0e3ce5e.js"><link rel="prefetch" href="/assets/js/205.ef5cf878.js"><link rel="prefetch" href="/assets/js/206.f493b40a.js"><link rel="prefetch" href="/assets/js/207.9d9957e2.js"><link rel="prefetch" href="/assets/js/208.2281320c.js"><link rel="prefetch" href="/assets/js/209.655132f6.js"><link rel="prefetch" href="/assets/js/21.3e0e5bfe.js"><link rel="prefetch" href="/assets/js/211.c6b13f8a.js"><link rel="prefetch" href="/assets/js/212.bb9af647.js"><link rel="prefetch" href="/assets/js/213.c08f9e12.js"><link rel="prefetch" href="/assets/js/214.4985bb11.js"><link rel="prefetch" href="/assets/js/215.e0c9d53d.js"><link rel="prefetch" href="/assets/js/216.d7fb3abe.js"><link rel="prefetch" href="/assets/js/217.e3de2249.js"><link rel="prefetch" href="/assets/js/218.786c54a9.js"><link rel="prefetch" href="/assets/js/219.153f455a.js"><link rel="prefetch" href="/assets/js/22.67d878c6.js"><link rel="prefetch" href="/assets/js/220.7e133cb1.js"><link rel="prefetch" href="/assets/js/221.0f186be9.js"><link rel="prefetch" href="/assets/js/222.d2fb2535.js"><link rel="prefetch" href="/assets/js/223.5f2ac5a3.js"><link rel="prefetch" href="/assets/js/224.861719f4.js"><link rel="prefetch" href="/assets/js/225.4375c5aa.js"><link rel="prefetch" href="/assets/js/226.ed5fbd41.js"><link rel="prefetch" href="/assets/js/227.902f0e4e.js"><link rel="prefetch" href="/assets/js/228.06bc0b4a.js"><link rel="prefetch" href="/assets/js/229.e4149636.js"><link rel="prefetch" href="/assets/js/23.ff2da312.js"><link rel="prefetch" href="/assets/js/230.4619ea07.js"><link rel="prefetch" href="/assets/js/231.230f34ff.js"><link rel="prefetch" href="/assets/js/232.08c31484.js"><link rel="prefetch" href="/assets/js/233.96a02257.js"><link rel="prefetch" href="/assets/js/234.3e475640.js"><link rel="prefetch" href="/assets/js/235.81b8da92.js"><link rel="prefetch" href="/assets/js/236.44d9122a.js"><link rel="prefetch" href="/assets/js/237.1271d67a.js"><link rel="prefetch" href="/assets/js/238.9d982a5a.js"><link rel="prefetch" href="/assets/js/239.b6ea5d7e.js"><link rel="prefetch" href="/assets/js/24.10d2c238.js"><link rel="prefetch" href="/assets/js/240.73e02431.js"><link rel="prefetch" href="/assets/js/241.70f2122b.js"><link rel="prefetch" href="/assets/js/242.37d37eba.js"><link rel="prefetch" href="/assets/js/243.5eced2f7.js"><link rel="prefetch" href="/assets/js/244.f8772176.js"><link rel="prefetch" href="/assets/js/245.bbacbeda.js"><link rel="prefetch" href="/assets/js/246.0dc03036.js"><link rel="prefetch" href="/assets/js/247.3f007b32.js"><link rel="prefetch" href="/assets/js/248.4cd6e290.js"><link rel="prefetch" href="/assets/js/249.e4a7fa57.js"><link rel="prefetch" href="/assets/js/25.8c62dcb0.js"><link rel="prefetch" href="/assets/js/250.9acac903.js"><link rel="prefetch" href="/assets/js/251.c703b649.js"><link rel="prefetch" href="/assets/js/252.8d036817.js"><link rel="prefetch" href="/assets/js/253.5cf61de4.js"><link rel="prefetch" href="/assets/js/254.5929c32f.js"><link rel="prefetch" href="/assets/js/255.eb7a9e3f.js"><link rel="prefetch" href="/assets/js/256.f82c6801.js"><link rel="prefetch" href="/assets/js/257.f6f9a922.js"><link rel="prefetch" href="/assets/js/258.f7150c44.js"><link rel="prefetch" href="/assets/js/259.a2befe3f.js"><link rel="prefetch" href="/assets/js/26.739943a8.js"><link rel="prefetch" href="/assets/js/260.d2ceb240.js"><link rel="prefetch" href="/assets/js/261.11214027.js"><link rel="prefetch" href="/assets/js/262.06c8402d.js"><link rel="prefetch" href="/assets/js/263.d89721ea.js"><link rel="prefetch" href="/assets/js/264.94be1b1c.js"><link rel="prefetch" href="/assets/js/265.28b256f8.js"><link rel="prefetch" href="/assets/js/266.2f2d0a86.js"><link rel="prefetch" href="/assets/js/267.244a453a.js"><link rel="prefetch" href="/assets/js/268.c9d0da03.js"><link rel="prefetch" href="/assets/js/269.6b84804e.js"><link rel="prefetch" href="/assets/js/27.16001572.js"><link rel="prefetch" href="/assets/js/270.d72a38d0.js"><link rel="prefetch" href="/assets/js/271.9d07f390.js"><link rel="prefetch" href="/assets/js/272.1eabd555.js"><link rel="prefetch" href="/assets/js/273.8ef862cb.js"><link rel="prefetch" href="/assets/js/274.b4a1ee60.js"><link rel="prefetch" href="/assets/js/275.0a4fd634.js"><link rel="prefetch" href="/assets/js/276.cc92ae86.js"><link rel="prefetch" href="/assets/js/277.f13e83f6.js"><link rel="prefetch" href="/assets/js/278.ab99f8d5.js"><link rel="prefetch" href="/assets/js/279.9c999b2d.js"><link rel="prefetch" href="/assets/js/28.0e00edec.js"><link rel="prefetch" href="/assets/js/280.c3ae2954.js"><link rel="prefetch" href="/assets/js/281.e3a8e124.js"><link rel="prefetch" href="/assets/js/282.41dfca8c.js"><link rel="prefetch" href="/assets/js/283.34e01262.js"><link rel="prefetch" href="/assets/js/284.bd12d38f.js"><link rel="prefetch" href="/assets/js/285.7e85d45e.js"><link rel="prefetch" href="/assets/js/286.e318cef6.js"><link rel="prefetch" href="/assets/js/287.9aea919b.js"><link rel="prefetch" href="/assets/js/288.0fc6a79b.js"><link rel="prefetch" href="/assets/js/289.04977573.js"><link rel="prefetch" href="/assets/js/29.13b94edf.js"><link rel="prefetch" href="/assets/js/290.d1a25906.js"><link rel="prefetch" href="/assets/js/291.349e8e14.js"><link rel="prefetch" href="/assets/js/292.5a3349c2.js"><link rel="prefetch" href="/assets/js/293.fd998980.js"><link rel="prefetch" href="/assets/js/294.fcc0932b.js"><link rel="prefetch" href="/assets/js/295.ad0c0a4e.js"><link rel="prefetch" href="/assets/js/296.f687c1ac.js"><link rel="prefetch" href="/assets/js/297.0383e8ad.js"><link rel="prefetch" href="/assets/js/298.f12a5734.js"><link rel="prefetch" href="/assets/js/299.7e459e37.js"><link rel="prefetch" href="/assets/js/3.adcbec93.js"><link rel="prefetch" href="/assets/js/30.93e7f877.js"><link rel="prefetch" href="/assets/js/300.13384580.js"><link rel="prefetch" href="/assets/js/301.b574a280.js"><link rel="prefetch" href="/assets/js/302.0da80f93.js"><link rel="prefetch" href="/assets/js/303.5bd62648.js"><link rel="prefetch" href="/assets/js/304.277f1560.js"><link rel="prefetch" href="/assets/js/305.2fb400b0.js"><link rel="prefetch" href="/assets/js/306.5591530b.js"><link rel="prefetch" href="/assets/js/307.03baf796.js"><link rel="prefetch" href="/assets/js/308.19322a60.js"><link rel="prefetch" href="/assets/js/309.2865acfb.js"><link rel="prefetch" href="/assets/js/31.5b22dbb7.js"><link rel="prefetch" href="/assets/js/310.576dbc00.js"><link rel="prefetch" href="/assets/js/311.cf8fabf8.js"><link rel="prefetch" href="/assets/js/312.39a65d0f.js"><link rel="prefetch" href="/assets/js/313.420ab61f.js"><link rel="prefetch" href="/assets/js/314.dcc48057.js"><link rel="prefetch" href="/assets/js/315.5b0b2441.js"><link rel="prefetch" href="/assets/js/316.a2581b07.js"><link rel="prefetch" href="/assets/js/317.72aa861a.js"><link rel="prefetch" href="/assets/js/318.cc76afe8.js"><link rel="prefetch" href="/assets/js/319.793aee8b.js"><link rel="prefetch" href="/assets/js/32.b9866617.js"><link rel="prefetch" href="/assets/js/320.d6f931c8.js"><link rel="prefetch" href="/assets/js/321.241c5325.js"><link rel="prefetch" href="/assets/js/322.25b2dd56.js"><link rel="prefetch" href="/assets/js/323.6e90d378.js"><link rel="prefetch" href="/assets/js/324.17d63946.js"><link rel="prefetch" href="/assets/js/325.29d7a602.js"><link rel="prefetch" href="/assets/js/326.6d8027cb.js"><link rel="prefetch" href="/assets/js/327.bc3bc15f.js"><link rel="prefetch" href="/assets/js/328.e3166599.js"><link rel="prefetch" href="/assets/js/329.4ee14451.js"><link rel="prefetch" href="/assets/js/33.0a48da5c.js"><link rel="prefetch" href="/assets/js/330.f3fbbca0.js"><link rel="prefetch" href="/assets/js/331.51b010c3.js"><link rel="prefetch" href="/assets/js/332.6568c142.js"><link rel="prefetch" href="/assets/js/333.e5160bc0.js"><link rel="prefetch" href="/assets/js/334.3f503206.js"><link rel="prefetch" href="/assets/js/335.a77287f3.js"><link rel="prefetch" href="/assets/js/336.bc825545.js"><link rel="prefetch" href="/assets/js/337.1e6e3548.js"><link rel="prefetch" href="/assets/js/338.cee11a1b.js"><link rel="prefetch" href="/assets/js/339.5ae13575.js"><link rel="prefetch" href="/assets/js/34.19cea838.js"><link rel="prefetch" href="/assets/js/340.241942f8.js"><link rel="prefetch" href="/assets/js/341.3c1b3334.js"><link rel="prefetch" href="/assets/js/342.e325d110.js"><link rel="prefetch" href="/assets/js/343.6fb23cbb.js"><link rel="prefetch" href="/assets/js/344.1e312068.js"><link rel="prefetch" href="/assets/js/345.eb119015.js"><link rel="prefetch" href="/assets/js/346.590b7466.js"><link rel="prefetch" href="/assets/js/347.d642932e.js"><link rel="prefetch" href="/assets/js/348.9a253540.js"><link rel="prefetch" href="/assets/js/349.1bae4df5.js"><link rel="prefetch" href="/assets/js/35.8ad77529.js"><link rel="prefetch" href="/assets/js/350.af306fed.js"><link rel="prefetch" href="/assets/js/351.54e3fb27.js"><link rel="prefetch" href="/assets/js/352.8329e7db.js"><link rel="prefetch" href="/assets/js/353.bacebc1c.js"><link rel="prefetch" href="/assets/js/354.0fabb2ea.js"><link rel="prefetch" href="/assets/js/355.a08d86b1.js"><link rel="prefetch" href="/assets/js/356.cf3325b4.js"><link rel="prefetch" href="/assets/js/357.312670b2.js"><link rel="prefetch" href="/assets/js/358.7384cfb0.js"><link rel="prefetch" href="/assets/js/359.8b6c2c02.js"><link rel="prefetch" href="/assets/js/36.01f75b05.js"><link rel="prefetch" href="/assets/js/360.0158848d.js"><link rel="prefetch" href="/assets/js/361.f9ccd2c3.js"><link rel="prefetch" href="/assets/js/362.a0c3f8fa.js"><link rel="prefetch" href="/assets/js/363.fea910be.js"><link rel="prefetch" href="/assets/js/364.8145e685.js"><link rel="prefetch" href="/assets/js/365.c272dd2a.js"><link rel="prefetch" href="/assets/js/366.06a1d9b3.js"><link rel="prefetch" href="/assets/js/367.3245841e.js"><link rel="prefetch" href="/assets/js/368.9af6cf99.js"><link rel="prefetch" href="/assets/js/369.f6833f93.js"><link rel="prefetch" href="/assets/js/37.ba86e777.js"><link rel="prefetch" href="/assets/js/370.489986a2.js"><link rel="prefetch" href="/assets/js/371.8a63cfd9.js"><link rel="prefetch" href="/assets/js/372.e82d9a72.js"><link rel="prefetch" href="/assets/js/373.d684c922.js"><link rel="prefetch" href="/assets/js/374.bbd25931.js"><link rel="prefetch" href="/assets/js/375.59134fdc.js"><link rel="prefetch" href="/assets/js/376.1d1391d8.js"><link rel="prefetch" href="/assets/js/377.e675f52b.js"><link rel="prefetch" href="/assets/js/378.94fc1900.js"><link rel="prefetch" href="/assets/js/379.d6203874.js"><link rel="prefetch" href="/assets/js/38.c1d6d798.js"><link rel="prefetch" href="/assets/js/39.ee7406fb.js"><link rel="prefetch" href="/assets/js/4.bea19bcf.js"><link rel="prefetch" href="/assets/js/40.4222bf33.js"><link rel="prefetch" href="/assets/js/41.67eefadc.js"><link rel="prefetch" href="/assets/js/42.2868150e.js"><link rel="prefetch" href="/assets/js/43.7002b07d.js"><link rel="prefetch" href="/assets/js/44.a857193b.js"><link rel="prefetch" href="/assets/js/45.745dcb38.js"><link rel="prefetch" href="/assets/js/46.33775fc9.js"><link rel="prefetch" href="/assets/js/47.73df6d71.js"><link rel="prefetch" href="/assets/js/48.1f3b7b84.js"><link rel="prefetch" href="/assets/js/49.b898b6c0.js"><link rel="prefetch" href="/assets/js/5.37946818.js"><link rel="prefetch" href="/assets/js/50.a994246f.js"><link rel="prefetch" href="/assets/js/51.7d4e5cef.js"><link rel="prefetch" href="/assets/js/52.ed37ae3e.js"><link rel="prefetch" href="/assets/js/53.469bc012.js"><link rel="prefetch" href="/assets/js/54.0dfb4e7a.js"><link rel="prefetch" href="/assets/js/55.226b632a.js"><link rel="prefetch" href="/assets/js/56.a81b057d.js"><link rel="prefetch" href="/assets/js/57.37d943d0.js"><link rel="prefetch" href="/assets/js/58.c9934f3d.js"><link rel="prefetch" href="/assets/js/59.32ec252d.js"><link rel="prefetch" href="/assets/js/6.a056165f.js"><link rel="prefetch" href="/assets/js/60.03f7c184.js"><link rel="prefetch" href="/assets/js/61.84f6f48c.js"><link rel="prefetch" href="/assets/js/62.7866714b.js"><link rel="prefetch" href="/assets/js/63.e5ab9ca0.js"><link rel="prefetch" href="/assets/js/64.6f096191.js"><link rel="prefetch" href="/assets/js/65.f18d3832.js"><link rel="prefetch" href="/assets/js/66.7cba7db3.js"><link rel="prefetch" href="/assets/js/67.0c3f4f51.js"><link rel="prefetch" href="/assets/js/68.4a92686b.js"><link rel="prefetch" href="/assets/js/69.d878bf0f.js"><link rel="prefetch" href="/assets/js/7.11908254.js"><link rel="prefetch" href="/assets/js/70.0e0df33e.js"><link rel="prefetch" href="/assets/js/71.10209cbc.js"><link rel="prefetch" href="/assets/js/72.ef389b0e.js"><link rel="prefetch" href="/assets/js/73.48e6c091.js"><link rel="prefetch" href="/assets/js/74.6e4a1866.js"><link rel="prefetch" href="/assets/js/75.c1a429f0.js"><link rel="prefetch" href="/assets/js/76.5ae212f4.js"><link rel="prefetch" href="/assets/js/77.96095e22.js"><link rel="prefetch" href="/assets/js/78.f88e262f.js"><link rel="prefetch" href="/assets/js/79.451d73d0.js"><link rel="prefetch" href="/assets/js/8.bf3017ac.js"><link rel="prefetch" href="/assets/js/80.c736bcfb.js"><link rel="prefetch" href="/assets/js/81.24f56b0c.js"><link rel="prefetch" href="/assets/js/82.358b1044.js"><link rel="prefetch" href="/assets/js/83.a63166c6.js"><link rel="prefetch" href="/assets/js/84.99932dc1.js"><link rel="prefetch" href="/assets/js/85.0ab61ae7.js"><link rel="prefetch" href="/assets/js/86.3a1c62ef.js"><link rel="prefetch" href="/assets/js/87.5b5b2cd1.js"><link rel="prefetch" href="/assets/js/88.b264e929.js"><link rel="prefetch" href="/assets/js/89.5f9e4a78.js"><link rel="prefetch" href="/assets/js/9.c8c748ec.js"><link rel="prefetch" href="/assets/js/90.5aef4772.js"><link rel="prefetch" href="/assets/js/91.b06460d5.js"><link rel="prefetch" href="/assets/js/92.ca85ba09.js"><link rel="prefetch" href="/assets/js/93.482a4d00.js"><link rel="prefetch" href="/assets/js/94.0b9fb6c7.js"><link rel="prefetch" href="/assets/js/95.6d8516ba.js"><link rel="prefetch" href="/assets/js/96.216b2b65.js"><link rel="prefetch" href="/assets/js/97.1aa6af78.js"><link rel="prefetch" href="/assets/js/98.51a62062.js"><link rel="prefetch" href="/assets/js/99.3b9a0f10.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bab6b875.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="äºŒä¸«è®²æ¢µ" class="logo"> <span class="site-name can-hide">äºŒä¸«è®²æ¢µ</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/ops/" class="nav-link">è¿ç»´</a></div><div class="nav-item"><a href="/topic/" class="nav-link">ä¸“é¢˜</a></div><div class="nav-item"><a href="/life/" class="nav-link">ç”Ÿæ´»</a></div><div class="nav-item"><a href="/code/" class="nav-link">ç¼–ç¨‹</a></div><div class="nav-item"><a href="/pages/11c668/" class="nav-link">å‘¨åˆŠ</a></div><div class="nav-item"><a href="/about/" class="nav-link">å…³äº</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/categories/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡µé¢" class="dropdown-title"><a href="/pages/ba90ae/" class="link-title">é¡µé¢</a> <span class="title" style="display:none;">é¡µé¢</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/ba90ae/" class="nav-link">å‹é“¾</a></li></ul></div></div> <a href="https://github.com/eryajf/eryajf.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://tva2.sinaimg.cn/large/008k1Yt0ly1gri6ownwg9j306o08wglu.jpg"> <div class="blogger-info"><h3>äºŒä¸«è®²æ¢µ</h3> <span>è¡Œè€…å¸¸è‡³ï¼Œä¸ºè€…å¸¸æˆ</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/ops/" class="nav-link">è¿ç»´</a></div><div class="nav-item"><a href="/topic/" class="nav-link">ä¸“é¢˜</a></div><div class="nav-item"><a href="/life/" class="nav-link">ç”Ÿæ´»</a></div><div class="nav-item"><a href="/code/" class="nav-link">ç¼–ç¨‹</a></div><div class="nav-item"><a href="/pages/11c668/" class="nav-link">å‘¨åˆŠ</a></div><div class="nav-item"><a href="/about/" class="nav-link">å…³äº</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/categories/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡µé¢" class="dropdown-title"><a href="/pages/ba90ae/" class="link-title">é¡µé¢</a> <span class="title" style="display:none;">é¡µé¢</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/ba90ae/" class="nav-link">å‹é“¾</a></li></ul></div></div> <a href="https://github.com/eryajf/eryajf.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nexusç³»åˆ—æ–‡ç« </span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Jenkinsç³»åˆ—æ–‡ç« </span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/56.html" class="sidebar-link">å‰è¨€</a></li><li><a href="/pages/63.html" class="sidebar-link">Jenkinsåˆå§‹éƒ¨ç½²ä¸ç®€å•é…ç½®</a></li><li><a href="/pages/77.html" class="sidebar-link">Jenkinså„é…ç½®é€‰é¡¹ä»‹ç»</a></li><li><a href="/pages/85.html" class="sidebar-link">Jenkinsä¸­ä¸€ä¸ªé¡¹ç›®çš„æ„å»º</a></li><li><a href="/pages/104.html" class="sidebar-link">Jenkinsé…ç½®é¡¹ç›®æ„å»ºçš„é’‰é’‰é€šçŸ¥</a></li><li><a href="/pages/106.html" class="sidebar-link">Jenkinså¿˜è®°ç®¡ç†å‘˜å¯†ç æ€ä¹ˆåŠ</a></li><li><a href="/pages/294.html" class="sidebar-link">Jenkinsä¸gitlabçš„äº¤äº’æ¢å¾®</a></li><li><a href="/pages/302.html" class="sidebar-link">Jenkinsæ ¹ç›®å½•è¯¦è§£</a></li><li><a href="/pages/329.html" class="sidebar-link">Jenkinsæ’ä»¶ä¹‹æ˜¾ç¤ºæ„å»ºæ—¶é—´</a></li><li><a href="/pages/334.html" class="sidebar-link">Jenkinsæ’ä»¶ä¹‹æ‰¹é‡ä¿®æ”¹é…ç½®</a></li><li><a href="/pages/342.html" class="sidebar-link">Jenkinsé…ç½®ç®€å•æ„å»ºé‚®ä»¶æ¨é€</a></li><li><a href="/pages/350.html" class="sidebar-link">Jenkinså¤æ‚é‚®ä»¶æ¨é€é…ç½®è¯¦è§£</a></li><li><a href="/pages/374.html" class="sidebar-link">Jenkinsé…ç½®å¤æ‚æ„å»ºé‚®ä»¶æ¨é€</a></li><li><a href="/pages/420.html" class="sidebar-link">Jenkinsæ„å»ºå®‰å“é¡¹ç›®ä¹‹å‰çš„ä¸€äº›å” å¨</a></li><li><a href="/pages/425.html" class="sidebar-link">Jenkinsæ„å»ºå®‰å“é¡¹ç›®é…ç½®</a></li><li><a href="/pages/613.html" class="sidebar-link">Jenkinsä¸Gitlabåˆ†æ”¯çš„äº¤äº’</a></li><li><a href="/pages/639.html" class="sidebar-link">Jenkinsæ„å»ºnodejsé¡¹ç›®</a></li><li><a href="/pages/701.html" class="sidebar-link">ä½¿ç”¨dockeréƒ¨ç½²JenkinsåŠåˆå§‹é…ç½®</a></li><li><a href="/pages/831.html" class="sidebar-link">é…ç½®gitlabæäº¤ä»£ç Jenkinsè‡ªåŠ¨æ„å»º</a></li><li><a href="/pages/1404.html" class="sidebar-link">Jenkinså›æ»šæ–¹æ¡ˆæ¢å¾®</a></li><li><a href="/pages/1445.html" class="sidebar-link">Jenkinsè§’è‰²æ§åˆ¶ï¼ˆå°é»„é”ï¼‰æ¢å¾®</a></li><li><a href="/pages/1626.html" class="sidebar-link">Jenkinsæ„å»ºçš„åº”ç”¨é…ç½®é—®é¢˜è§£å†³æ¢å¾®</a></li><li><a href="/pages/1676.html" class="sidebar-link">Jenkinsæ„å»ºä¸­tagçš„åº”ç”¨</a></li><li><a href="/pages/1786.html" class="sidebar-link">Jenkinsæ’ä»¶ä¹‹Ansicolor(ç¥å™¨)</a></li><li><a href="/pages/1919.html" class="sidebar-link">æœ€åŸºç¡€æ ¸å¿ƒçš„JenkinsåŠŸèƒ½éƒ¨ç½²ä¸€ä¸ªjavaåº”ç”¨</a></li><li><a href="/pages/1977.html" class="sidebar-link">Jenkins+sonaræ„å»ºä»£ç æ‰«æ</a></li><li><a href="/pages/2036.html" class="sidebar-link">Jenkins+docker+gitlabå°†åº”ç”¨éƒ¨ç½²åˆ°docker</a></li><li><a href="/pages/2075.html" class="sidebar-link">Jenkinså‚æ•°åŒ–æ„å»ºçŠ€åˆ©æ’ä»¶Active-Choices-Plugin</a></li><li><a href="/pages/2274.html" class="sidebar-link">è®°ä¸€æ¬¡å°†ä»£ç ä¸­å‚æ•°å¤–æ˜¾åˆ°æ„å»ºå†å²ä¸­çš„æ“ä½œ</a></li><li><a href="/pages/2705.html" class="sidebar-link">Jenkinså‡çº§ä¸è¿ç§»çš„ç»éªŒåˆ†äº«</a></li><li><a href="/pages/3292.html" class="sidebar-link">pipelineç¬”è®°ä¹‹ä»ä¸€ä¸ªç®€å•çš„é¡¹ç›®æ„å»ºå¼€å§‹</a></li><li><a href="/pages/3298.html" aria-current="page" class="active sidebar-link">Jenkinsfileå£°æ˜å¼è¯­æ³•è¯¦è§£</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/3298.html#_1-æ¡†æ¶ä»‹ç»ã€‚" class="sidebar-link">1ï¼Œæ¡†æ¶ä»‹ç»ã€‚</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/3298.html#_1-pipelineã€‚" class="sidebar-link">1ï¼Œpipelineã€‚</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_2-angetã€‚" class="sidebar-link">2ï¼Œangetã€‚</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_3-environment" class="sidebar-link">3ï¼Œenvironment</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_4-stages" class="sidebar-link">4ï¼Œstages</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_5-stage" class="sidebar-link">5ï¼Œstage</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_6-steps" class="sidebar-link">6ï¼Œsteps</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_2-ä¸»è¦å‚æ•°ã€‚" class="sidebar-link">2ï¼Œä¸»è¦å‚æ•°ã€‚</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/3298.html#_1-options" class="sidebar-link">1ï¼Œoptions</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_2-post" class="sidebar-link">2ï¼Œpost</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_3-tools" class="sidebar-link">3ï¼Œtools</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_4-parameters" class="sidebar-link">4ï¼Œparameters</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_5-input" class="sidebar-link">5ï¼Œinput</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_6-when" class="sidebar-link">6ï¼Œwhen</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_7-triggers" class="sidebar-link">7ï¼Œtriggers</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_8-parallel" class="sidebar-link">8ï¼Œparallel</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_3-å…¶ä»–å‚æ•°" class="sidebar-link">3ï¼Œå…¶ä»–å‚æ•°</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/3298.html#_1-sh" class="sidebar-link">1ï¼Œsh</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_2-deletedir" class="sidebar-link">2ï¼ŒdeleteDir</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_3-dirã€‚" class="sidebar-link">3ï¼Œdirã€‚</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_4-fileexists" class="sidebar-link">4ï¼ŒfileExists</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_5-error" class="sidebar-link">5ï¼Œerror</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_6-timeout" class="sidebar-link">6ï¼Œtimeout</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_7-waitutil" class="sidebar-link">7ï¼ŒwaitUtil</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_8-retry" class="sidebar-link">8ï¼Œretry</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_9-sleep" class="sidebar-link">9ï¼Œsleep</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_10-try-catch" class="sidebar-link">10ï¼Œtry&amp;catch</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_11-docker" class="sidebar-link">11ï¼Œdocker</a></li><li class="sidebar-sub-header"><a href="/pages/3298.html#_12-withenv" class="sidebar-link">12ï¼ŒwithEnv</a></li></ul></li></ul></li><li><a href="/pages/3304.html" class="sidebar-link">è‡ªåŠ¨æ„å»ºçš„åŸå§‹é…ç½®ä»¥åŠpipelineä¸­çš„ç”¨æ³•</a></li><li><a href="/pages/3306.html" class="sidebar-link">å¤šåˆ†æ”¯æ„å»ºçš„å®è·µä¸æ€è€ƒ</a></li><li><a href="/pages/3352.html" class="sidebar-link">ä½¿ç”¨Jenkinsfileç±»å‰ç«¯é¡¹ç›®çš„éƒ¨ç½²ä¸å›æ»š</a></li><li><a href="/pages/3491.html" class="sidebar-link">å¦‚ä½•åœ¨Jenkinsfileä¸­å®šä¹‰ä¸€ä¸ªå…¨å±€çš„æ—¶é—´æˆ³å˜é‡</a></li><li><a href="/pages/3508.html" class="sidebar-link">Jenkinsä¸­è‡ªç”±é£æ ¼å›æ»šæ–¹æ¡ˆçš„æœ€ä½³å®è·µ</a></li><li><a href="/pages/3510.html" class="sidebar-link">Jenkinsä¸­pipelineé£æ ¼å›æ»šæ–¹æ¡ˆçš„æœ€ä½³å®è·µ</a></li><li><a href="/pages/3512.html" class="sidebar-link">pipelineç»“åˆansibleå‰§æœ¬è¿›è¡Œæ‰¹é‡çš„éƒ¨ç½²ä¸å›æ»šé…ç½®</a></li><li><a href="/pages/3514.html" class="sidebar-link">æœ€è¿‘é…ç½®å®‰å“iOSæ‰“åŒ…æœ¬åœ°åŒ–æµç¨‹ä¸­ä¸€äº›å€¼å¾—è®°å½•çš„å†…å®¹</a></li><li><a href="/pages/5140.html" class="sidebar-link">pipelineä¸­å¦‚ä½•åœ¨environmentç¯èŠ‚å£°æ˜ä¸€ä¸ªå«æœ‰é€šé…ç¬¦çš„å˜é‡</a></li><li><a href="/pages/5328.html" class="sidebar-link">git-Parameteræ’ä»¶åœ¨pipelineå…±äº«åº“ä¸­çš„å®è·µè¯¦è§£</a></li><li><a href="/pages/2280.html" class="sidebar-link">Jenkinså¸¸ç”¨æ’ä»¶æ±‡æ€»ä»¥åŠç®€å•ä»‹ç»</a></li><li><a href="/pages/562.html" class="sidebar-link">Jenkinsæ‰€é‡æŠ¥é”™æ±‡æ€»åŠè§£å†³</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ELKç¬”è®°</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kubernetesç¬”è®°</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/categories/?category=%E7%B3%BB%E5%88%97%E4%B8%93%E9%A2%98" title="åˆ†ç±»" data-v-1cd794fe>ç³»åˆ—ä¸“é¢˜</a></li> <li data-v-1cd794fe><a href="/categories/?category=Jenkins%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0" title="åˆ†ç±»" data-v-1cd794fe>Jenkinsç³»åˆ—æ–‡ç« </a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/eryajf" target="_blank" title="ä½œè€…" class="beLink" data-v-1cd794fe>äºŒä¸«è®²æ¢µ</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2019-09-15</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          Jenkinsfileå£°æ˜å¼è¯­æ³•è¯¦è§£
        </h1>  <div class="theme-vdoing-content content__default"><p>ä¸Šç¯‡æ–‡ç« å¯¹Jenkins pipelineå…¥é—¨åšäº†ç®€å•ä»‹ç»ï¼Œç®€å•è§è¯†äº†Jenkinsfileå½“ä¸­çš„å‡ ä¸ªå¸¸ç”¨çš„è¯­æ³•å…³é”®å­—ï¼Œæœ¬æ–‡å°†é’ˆå¯¹å£°æ˜å¼çš„è¯­æ³•è¿›è¡Œè¯¦ç»†è§£è¯»ï¼Œè¿™ç§è§£è¯»å°†ä¼šæ˜¯æ‰‹å†Œæ€§è´¨çš„ï¼Œä¼šæœ‰è®²è§£ï¼Œå¿…è¦çš„ä¹Ÿä¼šæœ‰ç®€å•å®éªŒæ¼”ç¤ºï¼Œä½†æ˜¯å¹¶ä¸ä¼šåšå®Œæ•´é¡¹ç›®æµç¨‹çš„ä»‹ç»ã€‚</p> <p>æ‰‹å†Œæ€§è´¨çš„æ•´ç†ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿ä»¥åç”¨èµ·æ¥ä¹‹åï¼ŒæŸ¥è¯¢æ–¹ä¾¿ã€‚æˆ‘ä¸ªäººä¹Ÿå¸¸å¸¸å› ä¸ºé‡åˆ°ä¸€äº›é™Œç”Ÿçš„å‚æ•°ï¼Œæˆ–è€…ä¸ç†Ÿæ‚‰çš„ç”¨æ³•ï¼Œåˆ°ç½‘ä¸Šå„ç§æ‰¾ï¼Œæ£€ç´¢åˆ°çš„ç»“æœå¾€å¾€ä¹Ÿéƒ½ä¸ååˆ†æ»¡æ„ï¼Œå› æ­¤è¿™ç¯‡æ–‡ç« ï¼Œä¼šå°½é‡è¯¦ç»†è®°å½•å„ä¸ªæŒ‡ä»¤çš„å‚æ•°é¡¹ã€‚</p> <h2 id="_1-æ¡†æ¶ä»‹ç»ã€‚"><a href="#_1-æ¡†æ¶ä»‹ç»ã€‚" class="header-anchor">#</a> 1ï¼Œæ¡†æ¶ä»‹ç»ã€‚</h2> <p>ä¸€ä¸ªå¸¸è§„çš„å£°æ˜å¼Jenkinsfileï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæœ‰å¦‚ä¸‹å¸¸è§„æ¡†æ¶ï¼Œè¿™ä¸ªæ¡†æ¶åŸºæœ¬ä¸Šæ¯ä¸ªç¯èŠ‚éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œæ‰€ä»¥æˆ‘å°±ä»å¤–åˆ°å†…ï¼Œå…ˆä»æ•´ä½“æ¡†æ¶è®²èµ·ã€‚</p> <p>å½“æˆ‘ä»¬åœ¨vscodeå½“ä¸­å®‰è£…äº†Jenkins pipelineæ’ä»¶çš„ä¹‹åï¼Œè¾“å…¥pipeç„¶åå›è½¦ï¼Œé»˜è®¤è‡ªåŠ¨è¡¥å…¨å‡ºæ¥çš„å†…å®¹å¦‚ä¸‹ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline<span class="token punctuation">{</span>
    agent<span class="token punctuation">{</span>
        label <span class="token string gstring">&quot;node&quot;</span>
    <span class="token punctuation">}</span>
    stages<span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string gstring">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps<span class="token punctuation">{</span>
                echo <span class="token string gstring">&quot;========executing A========&quot;</span>
            <span class="token punctuation">}</span>
            post<span class="token punctuation">{</span>
                always<span class="token punctuation">{</span>
                    echo <span class="token string gstring">&quot;========always========&quot;</span>
                <span class="token punctuation">}</span>
                success<span class="token punctuation">{</span>
                    echo <span class="token string gstring">&quot;========A executed successfully========&quot;</span>
                <span class="token punctuation">}</span>
                failure<span class="token punctuation">{</span>
                    echo <span class="token string gstring">&quot;========A execution failed========&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    post<span class="token punctuation">{</span>
        always<span class="token punctuation">{</span>
            echo <span class="token string gstring">&quot;========always========&quot;</span>
        <span class="token punctuation">}</span>
        success<span class="token punctuation">{</span>
            echo <span class="token string gstring">&quot;========pipeline executed successfully ========&quot;</span>
        <span class="token punctuation">}</span>
        failure<span class="token punctuation">{</span>
            echo <span class="token string gstring">&quot;========pipeline execution failed========&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>ç°åœ¨å°±åŸºäºè¿™ä¸ªåŸºç¡€æ¡†æ¶ï¼Œä»‹ç»ä¸€ä¸‹å„ä¸ªç»„ä»¶ï¼Œå› ä¸ºè¿™äº›åœ¨ä¸Šç¯‡æ–‡ç« åŸºæœ¬ä¸Šéƒ½ä»‹ç»è¿‡ï¼Œæ‰€ä»¥ç•¥äººæ‰€è¯¦åœ°è¿›è¡Œä¸€ä¸‹è®²è§£ã€‚</p> <h3 id="_1-pipelineã€‚"><a href="#_1-pipelineã€‚" class="header-anchor">#</a> 1ï¼Œpipelineã€‚</h3> <p>ç”¨äºå£°æ˜è¡¨ç¤ºæµæ°´çº¿çš„æ ‡è¯†ï¼Œè¡¨ç¤ºè¿™é‡Œå°†é‡‡ç”¨å£°æ˜å¼çš„è¯­æ³•é£æ ¼ã€‚å¹¶ä¸åŒ…å«ä»€ä¹ˆç‰¹æ®Šæ„ä¹‰ã€‚</p> <h3 id="_2-angetã€‚"><a href="#_2-angetã€‚" class="header-anchor">#</a> 2ï¼Œangetã€‚</h3> <p>æ­¤å…³é”®å­—ç”¨äºè¡¨ç¤ºå½“å‰æµæ°´çº¿å°†è¦æ‰§è¡Œçš„ä½ç½®ï¼Œå½“æˆ‘ä»¬çš„Jenkinsæ˜¯ä¸»ä»é‚£ç§é›†ç¾¤çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡agentè¿›è¡ŒæŒ‡å®šï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åŸºäºdockerå®¹å™¨çš„æ„å»ºï¼Œå› ä¸ºç°åœ¨ä¸€åˆ‡éƒ½æ˜¯å®¹å™¨åŒ–çš„æ—¶ä»£ï¼Œæ‰€ä»¥è¿™é‡Œå°±åŸºäºå®¹å™¨çš„è¿™ç§æ–¹å¼ç¨å¾®å±•å¼€è®²ä¸€ä¸‹ï¼Œä»‹ç»ä¸€ä¸‹ç”¨æ³•ï¼Œä»¥åå¯èƒ½ä¼šä¸“é—¨ç”¨ä¸€ç¯‡æ–‡ç« å±•å¼€è¯¦è§£ä¸€ä¸‹å¦™ç”¨ã€‚</p> <h4 id="_1-å¸¸è§„ç”¨æ³•ã€‚"><a href="#_1-å¸¸è§„ç”¨æ³•ã€‚" class="header-anchor">#</a> 1ï¼Œå¸¸è§„ç”¨æ³•ã€‚</h4> <p>æ—¥å¸¸æ„å»ºéƒ¨ç½²ä¸­ï¼Œå¸¸å¸¸ä¼šç”¨åˆ°ç¼–è¯‘å·¥ä½œï¼Œå› æ­¤è¿™é‡Œçš„æ­¥éª¤å¯ä»¥æ”¾å…¥åˆ°é•œåƒä¸­æ‰§è¡Œï¼Œè¿™é‡Œåˆ©ç”¨nodeé¡¹ç›®çš„ç¼–è¯‘ä¸¾ä¸€ä¸ªç¤ºä¾‹ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent <span class="token punctuation">{</span>
        docker <span class="token punctuation">{</span>
        		lable <span class="token string">'docker'</span>
            image <span class="token string">'registry.cn-hangzhou.aliyuncs.com/eryajf/node:11.15'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Build'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'npm install --registry=https://registry.npm.taobao.org'</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>å½“æµæ°´çº¿æ‰§è¡Œçš„æ—¶å€™ï¼ŒJenkinsä¼šé¦–å…ˆå°†ä»£ç æ›´æ–°ï¼Œç„¶åå°† <code>$WORKSPACE</code> æŒ‚è½½åˆ°å®¹å™¨ä¹‹ä¸­ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡æ„å»ºæ—¥å¿—ä¸­çœ‹å‡ºæ¥ï¼š</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker run -t -d -u <span class="token number">0</span>:0 -w /root/.jenkins/workspace/test-pinpeline -v /root/.jenkins/workspace/test-pinpeline:/root/.jenkins/workspace/test-pinpeline:rw,z -v /root/.jenkins/workspace/test-pinpeline@tmp:/root/.jenkins/workspace/test-pinpeline@tmp:rw,z -e ******** registry.cn-hangzhou.aliyuncs.com/eryajf/node:11.15
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ¥ç€æ‰§è¡Œæˆ‘ä»¬å®šä¹‰çš„installç¼–è¯‘å‘½ä»¤ï¼Œå½“ç„¶ï¼Œä¸‹è¾¹å¯ä»¥ç»§ç»­æ·»åŠ æ­¥éª¤ï¼Œå°†ä»£ç rsyncåˆ°è¿œç¨‹ä¸»æœºï¼Œæˆ–è€…å…¶ä»–æ“ä½œã€‚</p> <p>æ­¤å¤„å¯ç”¨çš„å‚æ•°å¦‚ä¸‹ï¼š</p> <ul><li>lableï¼ˆå¯é€‰ï¼‰ï¼šå®šä¹‰ä¸€ä¸ªæ ‡ç­¾ï¼Œç”¨å¤„ä¸ååˆ†å¤§ã€‚</li> <li>imageï¼šå®šä¹‰æ„å»ºæ—¶ä½¿ç”¨çš„é•œåƒã€‚</li> <li>argsï¼šå¯ä»¥å®šä¹‰ç±»ä¼¼docker runå‘½ä»¤æ—¶çš„ä¸€äº›å‚æ•°ã€‚</li> <li>alwaysPullï¼šå¸ƒå°”ç±»å‹ï¼Œæ˜¯å¦åœ¨æ¯æ¬¡è¿è¡Œçš„æ—¶å€™é‡æ–°æ‹‰å–é•œåƒã€‚</li></ul> <h4 id="_2-æ·»åŠ å‚æ•°ã€‚"><a href="#_2-æ·»åŠ å‚æ•°ã€‚" class="header-anchor">#</a> 2ï¼Œæ·»åŠ å‚æ•°ã€‚</h4> <p>æ—¥å¸¸ç¼–è¯‘æ¯”è¾ƒå½±å“æ„å»ºæ—¶é—´çš„ä¸€ä¸ªå› ç´ æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œå› æ­¤è¿˜å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼å°†æœ¬åœ°ç¼“å­˜æŒ‚è½½åˆ°å®¹å™¨ä¹‹ä¸­ï¼Œä»è€ŒåŠ å¿«æ„å»ºé€Ÿåº¦ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent <span class="token punctuation">{</span>
        docker <span class="token punctuation">{</span>
            image <span class="token string">'registry.cn-hangzhou.aliyuncs.com/eryajf/node:11.15'</span>
            args <span class="token string">'-v /root/.npm:/root/.npm'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Build'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'npm install --registry=https://registry.npm.taobao.org'</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_3-å¤šä¸ªå®¹å™¨ã€‚"><a href="#_3-å¤šä¸ªå®¹å™¨ã€‚" class="header-anchor">#</a> 3ï¼Œå¤šä¸ªå®¹å™¨ã€‚</h4> <p>åŸºäºå¦‚ä¸Šçš„äº‹å®ï¼Œå‘æ•£æˆ‘ä»¬çš„æ€ç»´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è®¸å¤šä¸ªåŸºç¡€æ€§çš„æ­¥éª¤ï¼Œå°è£…æˆä¸€ä¸ªåˆä¸€ä¸ªé•œåƒï¼Œç„¶ååœ¨æ¯ä¸ªæ­¥éª¤ä¸­åªéœ€è°ƒç”¨å°è£…å¥½çš„é•œåƒï¼Œä¼ å…¥æ‰€éœ€çš„å‚æ•°ï¼Œå³å¯å®Œæˆæ¯”è¾ƒå¤æ‚çš„æ„å»ºã€‚</p> <p>å¤šä¸ªå®¹å™¨ç”¨æ³•ï¼Œå¦‚ä¸‹ç®€ç¤ºï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent none
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Build'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
            agent <span class="token punctuation">{</span>
                docker <span class="token punctuation">{</span>
                    image <span class="token string">'registry.cn-hangzhou.aliyuncs.com/eryajf/node:11.15'</span>
                    args <span class="token string">'-v /root/.npm:/root/.npm'</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'npm install --registry=https://registry.npm.taobao.org'</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'deploy'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            agent <span class="token punctuation">{</span>
                docker <span class="token punctuation">{</span>
                    image <span class="token string">'registry.cn-hangzhou.aliyuncs.com/mckj/ansible'</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'echo &quot;é€šè¿‡ansbileè¿›è¡Œéƒ¨ç½²&quot;'</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>å› ä¸ºJenkinsé»˜è®¤ä¼šå°†<code>$WORKSPACE</code>æŒ‚è½½åˆ°ä¸¤ä¸ªå®¹å™¨ä¸­ï¼Œå› æ­¤å„ç§æ“ä½œç›´æ¥åŸºäºå½“å‰ç›®å½•å³å¯ï¼Œè¿™æ˜¯å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹ã€‚</p> <p>è¿™é‡Œåªæ˜¯åšä¸€ä¸ªæ¼”ç¤ºï¼Œæä¾›ä¸€ç§æ€è·¯ï¼Œä»¥åæœ‰éœ€è¦ï¼Œå¯ä»¥å€Ÿæ­¤å‘æŒ¥æ›´å¤šçš„å¦™ç”¨ã€‚</p> <h4 id="_4-åŸºäºdockerfileã€‚"><a href="#_4-åŸºäºdockerfileã€‚" class="header-anchor">#</a> 4ï¼ŒåŸºäºDockerfileã€‚</h4> <p>è¿™ç§æ–¹å¼ï¼Œåº”ç”¨çš„å¤§æ¦‚æ¯”è¾ƒå°‘ï¼Œä»…åšç®€å•ä»‹ç»ã€‚</p> <p>é¦–å…ˆåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªDockerfileï¼š</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span>       eryajf/centos:7.5</span>
<span class="token instruction"><span class="token keyword">MAINTAINER</span> eryajf &lt;Linuxlql@163.com&gt;</span>

<span class="token comment"># Install node</span>
<span class="token instruction"><span class="token keyword">ADD</span>  node-v11.15.0-linux-x64.tar.xz   /usr/local/</span>

<span class="token instruction"><span class="token keyword">ENV</span> NODE /usr/local/node-v11.15.0-linux-x64</span>
<span class="token instruction"><span class="token keyword">ENV</span> PATH <span class="token variable">$PATH</span>:<span class="token variable">$NODE</span>/bin</span>

<span class="token instruction"><span class="token keyword">RUN</span> npm i -g pm2 gulp yarn --registry=https://registry.npm.taobao.org</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ç„¶åå®šä¹‰Jenkinsfileï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent <span class="token punctuation">{</span> dockerfile <span class="token boolean">true</span> <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Build'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'npm install --registry=https://registry.npm.taobao.org'</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>æ„Ÿè§‰èµ·æ¥ï¼Œè¿™ç§æ–¹å¼å¼•å…¥äº†è¿‡å¤šçš„ä¸ç¡®å®šå› ç´ ï¼Œå¯¹äºæ„å»ºç¨³å®šæ€§ï¼Œåè€Œä¸æ˜¯ä¸€ä»¶å¥½äº‹å„¿ï¼Œæ‰€ä»¥ä¸å¤ªæ¨èã€‚</p> <h3 id="_3-environment"><a href="#_3-environment" class="header-anchor">#</a> 3ï¼Œenvironment</h3> <p>ç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œä»¥ä¾¿äºä»£ç å¤ç”¨çš„æ—¶å€™ï¼Œæ›´åŠ æ¸…æ™°æ˜äº†çš„ç®€åŒ–å·¥ä½œå†…å®¹ï¼Œåªè¦é¡¹ç›®æ˜¯ç±»ä¼¼çš„ï¼Œé‚£ä¹ˆç›´æ¥åœ¨ <code>environment</code>åŒºåŸŸè¿›è¡Œé…ç½®å³å¯ï¼Œè€Œæ— éœ€ç©¿æ¢­åˆ°å¤æ‚çš„å†…å®¹é‡Œæ›´æ”¹é…ç½®ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå˜é‡çš„å£°æ˜å¯ä»¥åœ¨pipelineä»¥åŠstageåŒºåŸŸå½“ä¸­ï¼Œä¸å¤§å¤šæ•°è¯­è¨€ä¸€æ ·ï¼Œä¸åŒçš„åŒºåŸŸä½œç”¨åŸŸä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚</p> <h3 id="_4-stages"><a href="#_4-stages" class="header-anchor">#</a> 4ï¼Œstages</h3> <p>æ­¤å…³é”®å­—ç”¨äºè¡¨ç¤ºæµæ°´çº¿å„ä¸ªæ­¥éª¤çš„å£°æ˜ï¼Œå…¶ä¸‹ä¸€å±‚çº§æ˜¯stageï¼Œstageséƒ¨åˆ†è‡³å°‘åŒ…å«ä¸€ä¸ªstageã€‚</p> <h3 id="_5-stage"><a href="#_5-stage" class="header-anchor">#</a> 5ï¼Œstage</h3> <p>è¡¨ç¤ºå®é™…æ„å»ºçš„é˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µåšä¸åŒçš„äº‹æƒ…ï¼Œå¯æŒ‰å¦‚ä¸Šæ–¹å¼å®šä¹‰é˜¶æ®µçš„åç§°ã€‚</p> <h3 id="_6-steps"><a href="#_6-steps" class="header-anchor">#</a> 6ï¼Œsteps</h3> <p>æ ‡è¯†é˜¶æ®µä¹‹ä¸­å…·ä½“çš„æ„å»ºæ­¥éª¤ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ªæ­¥éª¤ï¼Œåœ¨stageä¸­æœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ªstepsã€‚</p> <h2 id="_2-ä¸»è¦å‚æ•°ã€‚"><a href="#_2-ä¸»è¦å‚æ•°ã€‚" class="header-anchor">#</a> 2ï¼Œä¸»è¦å‚æ•°ã€‚</h2> <h3 id="_1-options"><a href="#_1-options" class="header-anchor">#</a> 1ï¼Œoptions</h3> <p>ç”¨æ¥é…ç½®Jenkinsåº”ç”¨è‡ªèº«çš„ä¸€äº›é…ç½®é¡¹ï¼Œå¸¸ç”¨çš„å‚æ•°æœ‰å¦‚ä¸‹ï¼Œå¯æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œé€‰ç”¨ã€‚</p> <ul><li><p>buildDiscarder</p> <p>ä¿å­˜æœ€è¿‘å†å²æ„å»ºè®°å½•çš„æ•°é‡ï¼Œæ¯”è¾ƒç†Ÿæ‚‰Jenkinsçš„ç«¥é‹åº”è¯¥æ˜ç™½è¿™ä¸ªå‚æ•°çš„æ„ä¹‰ï¼Œå¯ä»¥æœ‰æ•ˆæ§åˆ¶Jenkinsä¸»æœºå­˜å‚¨ç©ºé—´ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>options <span class="token punctuation">{</span>
		<span class="token comment">// è¡¨ç¤ºä¿ç•™10æ¬¡æ„å»ºå†å²</span>
		<span class="token function">buildDiscarder</span><span class="token punctuation">(</span><span class="token function">logRotator</span><span class="token punctuation">(</span>numToKeepStr<span class="token punctuation">:</span> <span class="token string">'10'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>disableConcurrentBuilds</p> <p>ä¸å…è®¸åŒæ—¶æ‰§è¡Œæµæ°´çº¿ï¼Œè¢«ç”¨æ¥é˜²æ­¢åŒæ—¶è®¿é—®å…±äº«èµ„æºç­‰ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>options <span class="token punctuation">{</span>
		<span class="token function">disableConcurrentBuilds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>timeout</p> <p>è®¾ç½®é¡¹ç›®æ„å»ºè¶…æ—¶æ—¶é—´ï¼Œå¾ˆæ˜æ˜¾ï¼Œå¦‚æœè¶…æ—¶ï¼Œå°†ä¼šä»¥å¤±è´¥çŠ¶æ€ç»“æŸæ„å»ºã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>options <span class="token punctuation">{</span>
		<span class="token comment">// è®¾ç½®æµæ°´çº¿è¿è¡Œçš„è¶…è¿‡10åˆ†é’Ÿï¼ŒJenkinså°†ä¸­æ­¢æµæ°´çº¿</span>
		<span class="token function">timeout</span><span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> unit<span class="token punctuation">:</span> <span class="token string">'MINUTES'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>åŒç†è¿˜æœ‰å°æ—¶(HOURS)å’Œç§’(SECONDS)ï¼Œå¯æ ¹æ®å®é™…é¡¹ç›®éœ€æ±‚è¿›è¡Œå®šä¹‰ã€‚</p></li> <li><p>timestamps</p> <p>è®¾ç½®åœ¨é¡¹ç›®æ‰“å°æ—¥å¿—æ—¶å¸¦ä¸Šå¯¹åº”æ—¶é—´ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>options <span class="token punctuation">{</span>
		<span class="token comment">// è¾“å‡ºæ„å»ºçš„æ—¶é—´ä¿¡æ¯</span>
    <span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>skipDefaultCheckout</p> <p>åœ¨<code>agent</code> æŒ‡ä»¤ä¸­ï¼Œè·³è¿‡ä»æºä»£ç æ§åˆ¶ä¸­æ£€å‡ºä»£ç çš„é»˜è®¤æƒ…å†µã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>options <span class="token punctuation">{</span>
		<span class="token comment">// è·³è¿‡é»˜è®¤çš„ä»£ç æ£€å‡º</span>
		<span class="token function">skipDefaultCheckout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>checkoutToSubdirectory</p> <p>æŒ‡å®šä»£ç æ£€å‡ºåˆ° <code>$WORKSPACE</code>çš„å­ç›®å½•ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>options <span class="token punctuation">{</span>
		<span class="token function">checkoutToSubdirectory</span><span class="token punctuation">(</span><span class="token string">'testdir'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>retry</p> <p>åœ¨æ„å»ºå¤±è´¥çš„æ—¶å€™ï¼Œé‡æ–°å°è¯•æ•´ä¸ªæµæ°´çº¿çš„æŒ‡å®šæ¬¡æ•°ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>options <span class="token punctuation">{</span>
		<span class="token function">retry</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <p><code>å¸¸ç”¨æ±‡æ€»ï¼š</code></p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>options <span class="token punctuation">{</span>
		<span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token function">disableConcurrentBuilds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token function">timeout</span><span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> unit<span class="token punctuation">:</span> <span class="token string">'MINUTES'</span><span class="token punctuation">)</span>
    <span class="token function">buildDiscarder</span><span class="token punctuation">(</span><span class="token function">logRotator</span><span class="token punctuation">(</span>numToKeepStr<span class="token punctuation">:</span> <span class="token string">'10'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_2-post"><a href="#_2-post" class="header-anchor">#</a> 2ï¼Œpost</h3> <p>ç”¨äºå®šä¹‰åœ¨æ•´ä¸ªæµæ°´çº¿æ‰§è¡Œç»“æœçš„æƒ…å†µï¼Œé€šå¸¸å¯é…åˆé€šçŸ¥è¿›è¡Œå¯¹é¡¹ç›®æ„å»ºçŠ¶æ€çš„å‘ŠçŸ¥ã€‚æœ‰å¦‚ä¸‹å‡ ç§çŠ¶æ€ï¼š</p> <ul><li><p><code>always</code></p> <p>æ— è®ºæµæ°´çº¿æˆ–é˜¶æ®µçš„å®ŒæˆçŠ¶æ€å¦‚ä½•ï¼Œéƒ½å…è®¸åœ¨ <code>post</code> éƒ¨åˆ†è¿è¡Œè¯¥æ­¥éª¤ã€‚</p></li> <li><p><code>changed</code></p> <p>åªæœ‰å½“å‰æµæ°´çº¿æˆ–é˜¶æ®µçš„å®ŒæˆçŠ¶æ€ä¸å®ƒä¹‹å‰çš„è¿è¡Œä¸åŒæ—¶ï¼Œæ‰å…è®¸åœ¨ <code>post</code> éƒ¨åˆ†è¿è¡Œè¯¥æ­¥éª¤ã€‚</p></li> <li><p><code>failure</code></p> <p>åªæœ‰å½“å‰æµæ°´çº¿æˆ–é˜¶æ®µçš„å®ŒæˆçŠ¶æ€ä¸º&quot;failure&quot;ï¼Œæ‰å…è®¸åœ¨ <code>post</code> éƒ¨åˆ†è¿è¡Œè¯¥æ­¥éª¤, é€šå¸¸web UIæ˜¯çº¢è‰²ã€‚</p></li> <li><p><code>success</code></p> <p>åªæœ‰å½“å‰æµæ°´çº¿æˆ–é˜¶æ®µçš„å®ŒæˆçŠ¶æ€ä¸º&quot;success&quot;ï¼Œæ‰å…è®¸åœ¨ <code>post</code> éƒ¨åˆ†è¿è¡Œè¯¥æ­¥éª¤, é€šå¸¸web UIæ˜¯è“è‰²æˆ–ç»¿è‰²ã€‚</p></li> <li><p><code>unstable</code></p> <p>åªæœ‰å½“å‰æµæ°´çº¿æˆ–é˜¶æ®µçš„å®ŒæˆçŠ¶æ€ä¸º&quot;unstable&quot;ï¼Œæ‰å…è®¸åœ¨ <code>post</code> éƒ¨åˆ†è¿è¡Œè¯¥æ­¥éª¤, é€šå¸¸ç”±äºæµ‹è¯•å¤±è´¥,ä»£ç è¿è§„ç­‰é€ æˆã€‚é€šå¸¸web UIæ˜¯é»„è‰²ã€‚</p></li> <li><p><code>aborted</code></p> <p>åªæœ‰å½“å‰æµæ°´çº¿æˆ–é˜¶æ®µçš„å®ŒæˆçŠ¶æ€ä¸º&quot;aborted&quot;ï¼Œæ‰å…è®¸åœ¨ <code>post</code> éƒ¨åˆ†è¿è¡Œè¯¥æ­¥éª¤, é€šå¸¸ç”±äºæµæ°´çº¿è¢«æ‰‹åŠ¨çš„abortedã€‚é€šå¸¸web UIæ˜¯ç°è‰²ã€‚</p></li></ul> <p>å…³äºè¿™é‡Œï¼Œå¯ä»¥æœ‰æ¯”è¾ƒå·§å¦™çš„ç”¨æ³•ï¼Œåç»­å¯èƒ½ä¹Ÿä¼šä¸“é—¨åˆ—ä¸€ç¯‡æ–‡ç« æ¥ä¹¦å†™ã€‚</p> <h3 id="_3-tools"><a href="#_3-tools" class="header-anchor">#</a> 3ï¼Œtools</h3> <p>å®šä¹‰éƒ¨ç½²æµç¨‹ä¸­å¸¸ç”¨çš„ä¸€äº›å·¥å…·ï¼Œè¿™äº›å·¥å…·åœ¨<code>ç®¡ç†Jenkins</code>---&gt;<code>Global Tool Configuration</code>ä¸­æ·»åŠ ï¼Œç„¶ååœ¨é¡¹ç›®ä¸­å¼•ç”¨ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    tools <span class="token punctuation">{</span>
        maven <span class="token string">'maven'</span> 
    <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Example'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'mvn --version'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_4-parameters"><a href="#_4-parameters" class="header-anchor">#</a> 4ï¼Œparameters</h3> <p>parameters æŒ‡ä»¤æä¾›ç”¨æˆ·åœ¨è§¦å‘ Pipeline æ—¶åº”æä¾›çš„å‚æ•°åˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯åœ¨ä»¥å¾€çš„free styleé£æ ¼ä¸­æœ€å¸¸ç”¨åˆ°çš„å‚æ•°åŒ–æ„å»ºï¼Œæˆ‘ä»¬ä¸å¿…åœ¨æ¯æ¬¡æ–°å»ºé¡¹ç›®ä¹‹åï¼Œä¸€æ­¥ä¸€æ­¥åœ¨webç•Œé¢ä¸­é…ç½®éœ€è¦çš„å‚æ•°ï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥é€šè¿‡å£°æ˜å¼è¿›è¡Œå‚æ•°åŒ–é£æ ¼å®šä¹‰ï¼Œè¿™æ ·æå¤§ç®€åŒ–äº†é…ç½®å·¥ä½œã€‚</p> <p>parameters æŒ‡ä»¤æ”¯æŒä»¥ä¸‹å‡ ç§å¸¸ç”¨ç±»å‹ï¼š</p> <ul><li><p>stringï¼Œå­—ç¬¦ä¸²ç±»å‹ã€‚</p> <p>ä»¥å¾€å¸¸å¸¸é€šè¿‡è¿™ä¸ªå‚æ•°ï¼Œæ¥å®šä¹‰æ‰‹åŠ¨æ„å»ºæ—¶è¾“å…¥å°†è¦æ„å»ºçš„ä»£ç åˆ†æ”¯ï¼Œé‚£ä¹ˆè¿™é‡Œå¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼è¡¨è¾¾ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    parameters <span class="token punctuation">{</span>
        <span class="token function">string</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'branch'</span><span class="token punctuation">,</span> defaultValue<span class="token punctuation">:</span> <span class="token string">'master'</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">'è¯·è¾“å…¥å°†è¦æ„å»ºçš„ä»£ç åˆ†æ”¯'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>æ³¨æ„ï¼š</code>è¿™ç§å£°æ˜å®šä¹‰ä¹‹åï¼Œéœ€è¦æ‰‹åŠ¨æ„å»ºä¸€æ¬¡ï¼Œç„¶åé…ç½®å°±ä¼šè‡ªåŠ¨è½ä½åˆ°åŸæ¥ç†Ÿæ‚‰çš„å‚æ•°åŒ–æ„å»ºä¸­äº†ã€‚</p></li> <li><p>choiceï¼Œé€‰é¡¹å‚æ•°ç±»å‹ã€‚</p> <p>ä»¥å¾€ç»å¸¸ä¼šé€‰ç”¨è¿™ä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šæ„å»ºçš„æ–¹å‘æ˜¯éƒ¨ç½²è¿˜æ˜¯å›æ»šï¼Œå¤šä¸ªå‚æ•°æœ‰ä¸¤ç§è¡¨è¾¾æ–¹å¼ã€‚</p> <p><code>å…¶ä¸€ï¼š</code></p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    parameters <span class="token punctuation">{</span>
        <span class="token function">choice</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'mode'</span><span class="token punctuation">,</span> choices<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'deploy'</span><span class="token punctuation">,</span> <span class="token string">'rollback'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">'é€‰æ‹©æ–¹å‘ï¼'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>å…¶äºŒï¼š</code></p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    parameters <span class="token punctuation">{</span>
        <span class="token function">choice</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'ENV_TYPE'</span><span class="token punctuation">,</span> choices<span class="token punctuation">:</span> <span class="token string">'test\n\pre\nprod'</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">'è¯·é€‰æ‹©éƒ¨ç½²çš„ç¯å¢ƒ'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul> <p>ä»¥ä¸Šä¸¤ç§å‚æ•°ï¼Œåšä¸€ä¸ªç®€å•çš„é…ç½®å®éªŒï¼Œé¦–å…ˆå‡†å¤‡å¦‚ä¸‹ä¼ªä»£ç ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline<span class="token punctuation">{</span>
    agent any
    parameters <span class="token punctuation">{</span>
        <span class="token function">string</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'branch'</span><span class="token punctuation">,</span> defaultValue<span class="token punctuation">:</span> <span class="token string">'master'</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">'è¯·è¾“å…¥å°†è¦æ„å»ºçš„ä»£ç åˆ†æ”¯'</span><span class="token punctuation">)</span>
        <span class="token function">choice</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'mode'</span><span class="token punctuation">,</span> choices<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'deploy'</span><span class="token punctuation">,</span> <span class="token string">'rollback'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">'é€‰æ‹©æ–¹å‘ï¼'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps<span class="token punctuation">{</span>
                script <span class="token punctuation">{</span>
                    sh <span class="token string gstring">&quot;java -version&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>åˆ›å»ºä¸€ä¸ªæ–°çš„pipelineé£æ ¼çš„é¡¹ç›®ï¼Œå°†å¦‚ä¸Šä»£ç å¡«å†™è¿›å…¥ï¼Œç‚¹å‡»æ„å»ºï¼Œç„¶åå‚æ•°å°±ä¼šè½ä½åˆ°å¯¹åº”çš„ä½ç½®äº†ã€‚</p> <p><img src="http://tvax4.sinaimg.cn/large/71cfeb93ly1gmavsgu7pfj20wo0u0tcx.jpg" alt="img"></p> <p>æ¥ç€ç»§ç»­ä»‹ç»è¿™é‡Œçš„å‚æ•°ã€‚</p> <ul><li><p>booleanParamï¼Œå¸ƒå°”å€¼å‚æ•°</p> <p>å°±æ˜¯å®šä¹‰ä¸€ä¸ªå¸ƒå°”ç±»å‹å‚æ•°ï¼Œç”¨æˆ·å¯ä»¥åœ¨ Jenkins UI ä¸Šé€‰æ‹©æ˜¯è¿˜æ˜¯å¦ï¼Œé€‰æ‹©æ˜¯è¡¨ç¤ºä»£ç ä¼šæ‰§è¡Œè¿™éƒ¨åˆ†ï¼Œå¦‚æœé€‰æ‹©å¦ï¼Œä¼šè·³è¿‡è¿™éƒ¨åˆ†ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    parameters <span class="token punctuation">{</span>
        <span class="token function">booleanParam</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'DEBUG_BUILD'</span><span class="token punctuation">,</span> defaultValue<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>textï¼Œæ–‡æœ¬å‚æ•°</p> <p>æ–‡æœ¬ï¼ˆtextï¼‰çš„å‚æ•°å°±æ˜¯æ”¯æŒå†™å¾ˆå¤šè¡Œçš„å­—ç¬¦ä¸²ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    parameters <span class="token punctuation">{</span>
        <span class="token function">text</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'Deploy_text'</span><span class="token punctuation">,</span> defaultValue<span class="token punctuation">:</span> <span class="token string">'One\nTwo\nThree\n'</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>passwordï¼Œå¯†ç å‚æ•°</p> <p>å¯†ç ï¼ˆpasswordï¼‰å‚æ•°å°±æ˜¯åœ¨ Jenkins å‚æ•°åŒ–æ„å»º UI æä¾›ä¸€ä¸ªæš—æ–‡å¯†ç è¾“å…¥æ¡†ï¼Œæ‰€æœ‰éœ€è¦è„±æ•çš„ä¿¡æ¯ï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°æ¥é…ç½®ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>Pipeline <span class="token punctuation">{</span>
    agent any
    parameters <span class="token punctuation">{</span>
        <span class="token function">password</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'PASSWORD'</span><span class="token punctuation">,</span> defaultValue<span class="token punctuation">:</span> <span class="token string">'SECRET'</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">'A secret password'</span><span class="token punctuation">)</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <p>å¦‚ä¸Šå‚æ•°å·²ç»åŸºæœ¬ä¸Šå¯ä»¥æ»¡è¶³æ—¥å¸¸éœ€æ±‚ï¼Œæ€è·¯å¤§æ¦‚å°±æ˜¯é€šè¿‡Jenkinsfileçš„é…ç½®ï¼Œéƒ¨ç½²ä»æ—§æ²¿ç”¨ä»¥å¾€å¸¸è§„çš„æ‰‹åŠ¨éƒ¨ç½²çš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼åœ¨é«˜æ•ˆç‡æŒç»­æ„å»ºæ–¹é¢ï¼Œä¼¼ä¹å·²ç»ä¸å¤§é€‚åˆï¼Œæ‰€ä»¥ä»¥åå¯ä»¥ä¸inputå‚æ•°é…åˆä½¿ç”¨ï¼Œè¿™é‡Œä¸å±•å¼€ï¼Œä»¥åå¯ä¸“é—¨åˆ—ä¸€ç¯‡æ–‡ç« æ¥è®²ã€‚</p> <h3 id="_5-input"><a href="#_5-input" class="header-anchor">#</a> 5ï¼Œinput</h3> <p><code>stage</code> çš„ <code>input</code> æŒ‡ä»¤å…è®¸ä½ ä½¿ç”¨ <a href="https://jenkins.io/doc/pipeline/steps/pipeline-input-step/#input-wait-for-interactive-input" target="_blank" rel="noopener noreferrer"><code>input</code> step<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æç¤ºè¾“å…¥ã€‚ åœ¨åº”ç”¨äº† <code>options</code> åï¼Œè¿›å…¥ <code>stage</code> çš„ <code>agent</code> æˆ–è¯„ä¼° <code>when</code> æ¡ä»¶å‰ï¼Œ <code>stage</code> å°†æš‚åœã€‚ å¦‚æœ <code>input</code> è¢«æ‰¹å‡†, <code>stage</code> å°†ä¼šç»§ç»­ã€‚ ä½œä¸º <code>input</code> æäº¤çš„ä¸€éƒ¨åˆ†çš„ä»»ä½•å‚æ•°éƒ½å°†åœ¨ç¯å¢ƒä¸­ç”¨äºå…¶ä»– <code>stage</code>ã€‚</p> <p>ä¸€ä¸ªæˆç†Ÿçš„inputï¼Œå¤§æ¦‚éœ€è¦å¦‚ä¸‹å‡ ä¸ªè¦ç‚¹ï¼š</p> <ul><li><p>message</p> <ul><li>å¿…éœ€çš„ã€‚ è¿™å°†åœ¨ç”¨æˆ·æäº¤ <code>input</code> æ—¶ä½œä¸ºè¯´æ˜ä¿¡æ¯å‘ˆç°ç»™ç”¨æˆ·ã€‚</li></ul></li> <li><p>id</p> <ul><li><code>input</code> çš„å¯é€‰æ ‡è¯†ç¬¦ï¼Œ é»˜è®¤ä¸º <code>stage</code> åç§°ã€‚</li></ul></li> <li><p>ok</p> <ul><li>è‡ªå®šä¹‰ç¡®å®šæŒ‰é’®çš„æ–‡æœ¬ä¿¡æ¯ã€‚</li></ul></li> <li><p>submitter</p> <ul><li>å¯é€‰çš„ä»¥é€—å·åˆ†éš”çš„ç”¨æˆ·åˆ—è¡¨æˆ–å…è®¸æäº¤ <code>input</code> çš„å¤–éƒ¨ç»„åã€‚é»˜è®¤å…è®¸ä»»ä½•ç”¨æˆ·ã€‚</li></ul></li> <li><p>submitterParameter</p> <ul><li>ç¯å¢ƒå˜é‡çš„å¯é€‰åç§°ã€‚å¦‚æœå­˜åœ¨ï¼Œç”¨ <code>submitter</code> åç§°è®¾ç½®ã€‚</li></ul></li> <li><p>parameters</p> <ul><li>æç¤ºæäº¤è€…æä¾›çš„ä¸€ä¸ªå¯é€‰çš„å‚æ•°åˆ—è¡¨ï¼Œç»“åˆå¥½äº†ï¼Œä¼šæœ‰éå¸¸å¤šçš„å¦™ç”¨ã€‚</li></ul></li></ul> <p>è¿™é‡Œç®€å•åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œç”¨äºä¸€ç§æ€è·¯çš„å¼•å¯¼ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline<span class="token punctuation">{</span>
    agent any
    environment<span class="token punctuation">{</span>
    approvalMap <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'pre deploy'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps<span class="token punctuation">{</span>
                script<span class="token punctuation">{</span>
                    approvalMap <span class="token operator">=</span> input <span class="token punctuation">(</span>
                        message<span class="token punctuation">:</span> <span class="token string">'å‡†å¤‡å‘å¸ƒåˆ°å“ªä¸ªç¯å¢ƒï¼Ÿ'</span><span class="token punctuation">,</span>
                        ok<span class="token punctuation">:</span> <span class="token string">'ç¡®å®š'</span><span class="token punctuation">,</span>
                        parameters<span class="token punctuation">:</span><span class="token punctuation">[</span>
                            <span class="token function">choice</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'ENV'</span><span class="token punctuation">,</span>choices<span class="token punctuation">:</span> <span class="token string">'test\npre\nprod'</span><span class="token punctuation">,</span>description<span class="token punctuation">:</span> <span class="token string">'å‘å¸ƒåˆ°ä»€ä¹ˆç¯å¢ƒï¼Ÿ'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token function">string</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">'myparam'</span><span class="token punctuation">,</span>defaultValue<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>description<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span>
                        <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        submitter<span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>
                        submitterParameter<span class="token punctuation">:</span> <span class="token string">'APPROVER'</span>
                    <span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'deploy'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps<span class="token punctuation">{</span>
                echo <span class="token string gstring">&quot;æ“ä½œè€…æ˜¯ <span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>approvalMap<span class="token punctuation">[</span><span class="token string">'APPROVER'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>&quot;</span>
                echo <span class="token string gstring">&quot;å‘å¸ƒåˆ°ä»€ä¹ˆç¯å¢ƒ <span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>approvalMap<span class="token punctuation">[</span><span class="token string">'ENV'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>&quot;</span>
                echo <span class="token string gstring">&quot;è‡ªå®šä¹‰å‚æ•° <span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>approvalMap<span class="token punctuation">[</span><span class="token string">'myparam'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>ç‚¹å‡»æ„å»ºï¼Œç¨‹åºå°†ä¼šåœ¨inputçš„æ­¥éª¤åœä½ï¼Œç­‰å¾…ç”¨æˆ·è¿›è¡Œç›¸åº”è¾“å…¥ï¼Œä»è€Œè¿›è¡Œä¸åŒæ„å»ºï¼Œå½“ç„¶ï¼Œè¿™é‡Œçš„å¤šç¯å¢ƒåªæ˜¯åšäº†ä¸€ä¸ªç®€å•çš„æ‰“å°ï¼Œå¦‚æœå†ç»“åˆä¸Šåˆ¤æ–­ï¼Œä»¥åŠä¸åŒåˆ†æ”¯æ„å»ºï¼Œå°±èƒ½å®ç°æ›´åŠ ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä¸ç”¨ç€æ€¥ï¼Œå¾ˆå¿«å°±ä¼šä»‹ç»Jenkinsfileä¸­çš„åˆ¤æ–­äº†ã€‚</p> <p><code>æ³¨æ„ï¼š</code>å¼€å¤´ç¯å¢ƒå˜é‡ï¼Œå…ˆåˆ›å»ºäº†ä¸€ä¸ªç©ºçš„åç§°ï¼Œåè¾¹å†å°†å®šä¹‰çš„å‚æ•°ç»“æœèµ‹å€¼ç»™å¼€å¤´çš„å˜é‡ï¼Œè¿™æ ·ä¾¿äºåè¾¹è°ƒç”¨ï¼Œè°ƒç”¨æ—¶ç›´æ¥å¼•ç”¨è¿™ä¸ªMapç±»å‹å³å¯ã€‚å¦å¤–ï¼Œå› ä¸ºè¿™ç§èµ‹å€¼çš„æ–¹å¼å±äºGroovyè¯­è¨€çš„èµ‹å€¼æ–¹å¼ï¼Œå› æ­¤å¯¹åº”çš„èµ‹å€¼è¿‡ç¨‹éœ€è¦æ”¾åœ¨scriptå—ä¸­ã€‚</p> <h3 id="_6-when"><a href="#_6-when" class="header-anchor">#</a> 6ï¼Œwhen</h3> <p><code>when</code> æŒ‡ä»¤å…è®¸æµæ°´çº¿æ ¹æ®ç»™å®šçš„æ¡ä»¶å†³å®šæ˜¯å¦åº”è¯¥æ‰§è¡Œé˜¶æ®µã€‚ <code>when</code> æŒ‡ä»¤å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªæ¡ä»¶ã€‚ å¦‚æœ <code>when</code> æŒ‡ä»¤åŒ…å«å¤šä¸ªæ¡ä»¶, æ‰€æœ‰çš„å­æ¡ä»¶å¿…é¡»è¿”å›Trueï¼Œé˜¶æ®µæ‰èƒ½æ‰§è¡Œã€‚</p> <p>whenæŒ‡ä»¤æœ‰ä¸€äº›å†…ç½®çš„æ¡ä»¶åˆ¤æ–­å…³é”®å­—ï¼Œè¿™äº›å…³é”®å­—ç”¨å¥½äº†ï¼Œä¼šç»™ç”Ÿäº§å¸¦æ¥æå¤§çš„æ•ˆç‡æå‡ï¼Œæ¥ä¸‹æ¥å°±æ¥è®¤è¯†ä¸€ä¸‹è¿™äº›å…³é”®å­—ã€‚</p> <h4 id="_1-branch"><a href="#_1-branch" class="header-anchor">#</a> 1ï¼Œbranch</h4> <p>å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªå‚æ•°æ˜¯é’ˆå¯¹äºé¡¹ç›®åˆ†å€¼æ¥åšåˆ¤æ–­çš„ï¼Œåœ¨é…ç½®å¤šåˆ†æ”¯æ„å»ºçš„åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚æ¯”å¦‚ç»“åˆä¸Šè¾¹inputçš„åœºæ™¯ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦å‚æ•°ï¼Œç”¨äºåŒºåˆ«ä»£ç å‘å¸ƒçš„åˆ†æ”¯ä¸ç¯å¢ƒï¼Œä¸åŒçš„åˆ†æ”¯éƒ¨ç½²åˆ°ä¸åŒçš„ç¯å¢ƒï¼ŒåŸæ¥çš„æ€è·¯ï¼Œå¤§æ¦‚æ˜¯ç”¨if-elseåˆ¤æ–­æ¥å®ç°ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'deploy to test'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    steps<span class="token punctuation">{</span>
        script<span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>GIT_BRANCH <span class="token operator">==</span> <span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                echo <span class="token string gstring">&quot;deploy to test env&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'deploy to prod'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    steps<span class="token punctuation">{</span>
        script<span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>GIT_BRANCH <span class="token operator">==</span> <span class="token string">'master'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                echo <span class="token string gstring">&quot;deploy to prod env&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>å‰è¾¹æåˆ°è¿‡ï¼Œscriptæ˜¯Groovyé£æ ¼çš„è¯­æ³•ï¼Œå¹¶ä¸æ˜¯æœ¬æ–‡æ¨èçš„é£æ ¼ï¼Œå› æ­¤å¯ä»¥ç”¨whenæ¥ä»£æ›¿ä¸Šè¾¹çš„ä»£ç ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'deploy to test'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    when <span class="token punctuation">{</span>
        branch <span class="token string">'test'</span>
    <span class="token punctuation">}</span>
    steps<span class="token punctuation">{</span>
        echo <span class="token string gstring">&quot;deploy to test env&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'deploy to prod'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    when <span class="token punctuation">{</span>
        branch <span class="token string">'master'</span>
    <span class="token punctuation">}</span>
    steps<span class="token punctuation">{</span>
        echo <span class="token string gstring">&quot;deploy to prod env&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>æ³¨æ„ï¼š</code>è¿™é‡Œçš„branchè¯­æ³•åŒ¹é…ï¼Œè¿˜æ”¯æŒé€šé…ç¬¦ç±»å‹çš„ï¼Œæ¯”å¦‚ï¼Œ<code>branch 'test.*'</code>ï¼Œè¡¨ç¤ºåŒ¹é…åˆ°ä»¥testå¼€å¤´çš„åˆ†æ”¯ã€‚</p> <p>è¿™ç§ç”¨æ³•æ›´å¤šåº”ç”¨åœ¨å¤šåˆ†æ”¯æ„å»ºåœºæ™¯ä¸­ï¼Œåè¾¹æœ‰æœºä¼šå°†ä¼šä¸“é—¨ç”¨ä¸€ç¯‡æ–‡ç« æ¥ä»‹ç»ã€‚</p> <h4 id="_2-environment"><a href="#_2-environment" class="header-anchor">#</a> 2ï¼Œenvironment</h4> <p>åŒæ ·ä¹Ÿæ˜¯ä¸€ä¸ªåˆ¤æ–­ï¼Œåªä¸è¿‡åˆ¤æ–­çš„å‚æ•°æ¥æºæ˜¯ç¯å¢ƒå˜é‡çš„å€¼ï¼Œå¦‚æœç¯å¢ƒå˜é‡çš„å€¼ä¸æˆ‘ä»¬å®šä¹‰çš„ç›¸åŒï¼Œåˆ™æ‰§è¡Œï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when<span class="token punctuation">{</span>
    environment name<span class="token punctuation">:</span> <span class="token string">'ENV'</span><span class="token punctuation">,</span>value<span class="token punctuation">:</span> <span class="token string">'prod'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-not"><a href="#_3-not" class="header-anchor">#</a> 3ï¼Œnot</h4> <p>å½“åµŒå¥—æ¡ä»¶æ˜¯é”™è¯¯æ—¶ï¼Œæ‰§è¡Œè¿™ä¸ªé˜¶æ®µï¼Œå¿…é¡»åŒ…å«ä¸€ä¸ªæ¡ä»¶ï¼Œä¾‹å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
		not <span class="token punctuation">{</span> branch <span class="token string">'master'</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>åˆ¤æ–­ç¯å¢ƒæ¡ä»¶æ—¶ï¼Œç”¨å¦‚ä¸‹å†™æ³•ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
		not <span class="token punctuation">{</span> environment name<span class="token punctuation">:</span> <span class="token string">'mode'</span><span class="token punctuation">,</span>value<span class="token punctuation">:</span> <span class="token string">'deploy'</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_4-allof"><a href="#_4-allof" class="header-anchor">#</a> 4ï¼ŒallOf</h4> <p>å½“æ‰€æœ‰çš„åµŒå¥—æ¡ä»¶éƒ½æ­£ç¡®æ—¶ï¼Œæ‰æ‰§è¡Œã€‚ä¾‹å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
		allOf <span class="token punctuation">{</span> 
				branch <span class="token string">'master'</span><span class="token punctuation">;</span> 
				environment name<span class="token punctuation">:</span> <span class="token string">'DEPLOY_TO'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'production'</span> 
		<span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_5-anyof"><a href="#_5-anyof" class="header-anchor">#</a> 5ï¼ŒanyOf</h4> <p>å½“è‡³å°‘æœ‰ä¸€ä¸ªåµŒå¥—æ¡ä»¶ä¸ºçœŸæ—¶ï¼Œæ‰§è¡Œè¿™ä¸ªé˜¶æ®µï¼Œå¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªæ¡ä»¶ï¼Œä¾‹å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
		anyOf <span class="token punctuation">{</span> 
				branch <span class="token string">'master'</span><span class="token punctuation">;</span> 
				branch <span class="token string">'dev'</span> 
		<span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_6-beforeagent"><a href="#_6-beforeagent" class="header-anchor">#</a> 6ï¼ŒbeforeAgent</h4> <p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œç¨‹åºéƒ½æ˜¯è‡ªä¸Šè€Œä¸‹æ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯åœ¨agentä¹‹åæ‰ä¼šæ‰§è¡Œwhenï¼Œä½†æ˜¯æŸäº›åœºæ™¯ä¸­ï¼Œå¯èƒ½æˆ‘ä»¬éœ€è¦å…ˆåšä¸€ä¸‹åˆ¤æ–­ï¼Œç„¶åå†è¿›å…¥åˆ°agentå­—æ®µä¸­çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ°beforeAgentã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent none
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Example Build'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'Hello World'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Example Deploy'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            agent <span class="token punctuation">{</span>
                label <span class="token string gstring">&quot;some-label&quot;</span>
            <span class="token punctuation">}</span>
            when <span class="token punctuation">{</span>
                beforeAgent <span class="token boolean">true</span>
                branch <span class="token string">'production'</span>
            <span class="token punctuation">}</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'Deploying'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="_7-expression"><a href="#_7-expression" class="header-anchor">#</a> 7ï¼Œexpression</h4> <p><strong><code>expression</code></strong> ï¼šå½“æŒ‡å®šçš„Groovyè¡¨è¾¾å¼æ±‚å€¼ä¸ºtrueæ—¶æ‰§è¡Œé˜¶æ®µã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
	expression <span class="token punctuation">{</span> <span class="token keyword">return</span> params<span class="token punctuation">.</span>DEBUG_BUILD <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>æ³¨æ„ï¼Œä»è¡¨è¾¾å¼è¿”å›å­—ç¬¦ä¸²æ—¶ï¼Œå¿…é¡»å°†å®ƒä»¬è½¬æ¢ä¸ºå¸ƒå°”å€¼æˆ–è¿”å›<code>null</code>è¡¨ç¤ºä¸º<code>false</code>ã€‚ ç®€å•åœ°è¿”å›<code>0</code>æˆ–<code>false</code>ä»å°†è¯„ä¼°ä¸º<code>true</code>ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span>
	expression <span class="token punctuation">{</span> BRANCH_NAME <span class="token operator">==~</span> <span class="token string regex">/(production|staging)/</span> <span class="token punctuation">}</span>
	anyOf <span class="token punctuation">{</span>
		environment name<span class="token punctuation">:</span> <span class="token string">'DEPLOY_TO'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'production'</span>
		environment name<span class="token punctuation">:</span> <span class="token string">'DEPLOY_TO'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'staging'</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_8-changelog"><a href="#_8-changelog" class="header-anchor">#</a> 8ï¼Œchangelog</h4> <p>å¦‚æœæ„å»ºçš„SCMæ›´æ–°æ—¥å¿—åŒ…å«ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼Œåˆ™æ‰§è¡Œè¯¥é˜¶æ®µ ä¾‹å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
	changelog <span class="token string">'.*^\\[DEPENDENCY\\] .+$'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_9-changeset"><a href="#_9-changeset" class="header-anchor">#</a> 9ï¼Œchangeset</h4> <p>å¦‚æœæ„å»ºçš„SCMå˜æ›´é›†åŒ…å«ä¸ç»™å®šå­—ç¬¦ä¸²æˆ–globåŒ¹é…çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œåˆ™æ‰§è¡Œè¯¥é˜¶æ®µã€‚ ä¾‹å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
	changeset <span class="token string gstring">&quot;**/*.js&quot;</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè·¯å¾„åŒ¹é…ä¸åŒºåˆ†å¤§å°å†™ï¼Œå¯ä»¥ä½¿ç”¨caseSensitiveå‚æ•°å…³é—­, ä¾‹å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
	changeset glob<span class="token punctuation">:</span> <span class="token string gstring">&quot;ReadMe.*&quot;</span><span class="token punctuation">,</span> caseSensitive<span class="token punctuation">:</span> <span class="token boolean">true</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_10-equals"><a href="#_10-equals" class="header-anchor">#</a> 10ï¼Œequals</h4> <p>å½“æœŸæœ›å€¼ç­‰äºå®é™…å€¼æ—¶æ‰§è¡Œé˜¶æ®µï¼Œ ä¾‹å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
	equals expected<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> actual<span class="token punctuation">:</span> currentBuild<span class="token punctuation">.</span>number 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_11-tag"><a href="#_11-tag" class="header-anchor">#</a> 11ï¼Œtag</h4> <p>å¦‚æœ<code>TAG_NAME</code>å˜é‡ä¸ç»™å®šæ¨¡å¼åŒ¹é…ï¼Œåˆ™æ‰§è¡Œè¯¥é˜¶æ®µã€‚ä¾‹å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
	tag <span class="token string gstring">&quot;release-*&quot;</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å¦‚æœæä¾›äº†ç©ºæ¨¡å¼ï¼Œåˆ™å¦‚æœ<code>TAG_NAME</code>å˜é‡å­˜åœ¨ï¼Œåˆ™å°†æ‰§è¡Œè¯¥é˜¶æ®µï¼ˆä¸buildingTagï¼ˆï¼‰ç›¸åŒï¼‰ã€‚</p> <p>å¯ä»¥åœ¨å±æ€§ä¹‹åæ·»åŠ å¯é€‰å‚æ•°æ¯”è¾ƒå™¨ï¼Œä»¥æŒ‡å®šå¦‚ä½•è¯„ä¼°åŒ¹é…çš„ä»»ä½•æ¨¡å¼ï¼š<code>EQUALS</code>ç”¨äºç®€å•å­—ç¬¦ä¸²æ¯”è¾ƒï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œ<code>GLOB</code>ç”¨äºANTæ ·å¼è·¯å¾„globï¼ˆä¸ä¾‹å¦‚å˜æ›´é›†ç›¸åŒï¼‰æˆ–<code>REGEXP</code>ç”¨äºå¸¸è§„ è¡¨è¾¾åŒ¹é…ã€‚ ä¾‹å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> 
	tag pattern<span class="token punctuation">:</span> <span class="token string gstring">&quot;release-\\d+&quot;</span><span class="token punctuation">,</span> comparator<span class="token punctuation">:</span> <span class="token string gstring">&quot;REGEXP&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_12-triggeredby"><a href="#_12-triggeredby" class="header-anchor">#</a> 12ï¼ŒtriggeredBy</h4> <p>åœ¨ç»™å®šçš„å‚æ•°è§¦å‘å½“å‰æ„å»ºæ—¶æ‰§è¡Œè¯¥é˜¶æ®µã€‚ä¾‹å¦‚ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>when <span class="token punctuation">{</span> triggeredBy <span class="token string">'SCMTrigger'</span> <span class="token punctuation">}</span>

when <span class="token punctuation">{</span> triggeredBy <span class="token string">'TimerTrigger'</span> <span class="token punctuation">}</span>

when <span class="token punctuation">{</span> triggeredBy <span class="token string">'UpstreamCause'</span> <span class="token punctuation">}</span>

when <span class="token punctuation">{</span> triggeredBy cause<span class="token punctuation">:</span> <span class="token string gstring">&quot;UserIdCause&quot;</span><span class="token punctuation">,</span> detail<span class="token punctuation">:</span> <span class="token string gstring">&quot;vlinde&quot;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_7-triggers"><a href="#_7-triggers" class="header-anchor">#</a> 7ï¼Œtriggers</h3> <p><code>triggers</code>æŒ‡ä»¤ç”¨äºå®šä¹‰æµæ°´çº¿è§¦å‘çš„ä¸€äº›æœºåˆ¶ä¸æ¡ä»¶ã€‚å¸¸è§„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„é¡¹ç›®éƒ½æ˜¯åŸºäºæ‰‹åŠ¨ç‚¹å‡»éƒ¨ç½²ï¼Œè¿™ç§ç­–ç•¥å°¤å…¶é€‚ç”¨äºçº¿ä¸Šç¯å¢ƒï¼Œä½†åœ¨æµ‹è¯•ç¯å¢ƒï¼Œä¹ƒè‡³äºé¢„å‘ç¯å¢ƒï¼Œåº”è¯¥å¯¹è‡ªåŠ¨æ„å»ºæœ‰æ›´é«˜çš„é›†æˆåº¦ï¼Œä½¿å¼€å‘è€…åªå…³æ³¨äºå¼€å‘ï¼Œè€Œä¸å¿…è¿‡å¤šçº ç»“æ„å»ºçš„è¿‡ç¨‹ã€‚</p> <p>ç›®å‰æµæ°´çº¿æ”¯æŒçš„è§¦å‘å™¨æœ‰ä¸‰ç§ï¼š<code>cron</code>, <code>pollSCM</code> å’Œ <code>upstream</code>ã€‚</p> <h4 id="_1-cron"><a href="#_1-cron" class="header-anchor">#</a> 1ï¼Œcron</h4> <p>é‡‡ç”¨ä¸Linuxç³»ç»Ÿä¸€æ ·çš„å®šæ—¶ä»»åŠ¡ç®¡ç†æ–¹æ¡ˆï¼Œå½“ç„¶ä¹ŸåŠ å…¥äº†ä¸€äº›æ›´ç®€å•çš„å‚æ•°é¡¹ï¼Œä»¥åº”å¯¹æŸäº›éœ€è¦å®šæœŸæ‰§è¡Œçš„åœºæ™¯ï¼Œå…¶å®å¦‚æœå‘æ•£ä¸€ä¸‹æ€ç»´ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨cronè¿™ç§åŠŸèƒ½ï¼Œæ¥ä½œä¸ºæ•´ä¸ªç³»ç»Ÿçš„å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸­å¿ƒï¼Œæ‰€æœ‰ä¸»æœºçš„å®šæ—¶ä»»åŠ¡éƒ½æ±‡æ€»åˆ°è¿™é‡Œæ¥ï¼Œç®¡ç†èµ·æ¥ä¹Ÿæ–¹ä¾¿å¾ˆå¤šã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    triggers <span class="token punctuation">{</span>
        <span class="token function">cron</span><span class="token punctuation">(</span><span class="token string">'* * * * *'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'cronjob test'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'è¿™æ˜¯ä¸€ä¸ªå®šæœŸæ‰§è¡Œçš„ä»»åŠ¡'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>å®šæ—¶ä»»åŠ¡çš„è¯­æ³•å°±ä¸å±•å¼€è®²äº†ï¼Œåªåˆ—å‡ ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ï¼Œè€Œä¸”æ¯”è¾ƒæœ‰ç©ºçš„ã€‚</p> <ul><li><p><code>H</code>å…³é”®å­—ï¼ŒHäº¦å³Hashï¼Œè¡¨ç¤ºå½“å‰ä½ç½®è·¨åº¦èŒƒå›´å†…éšæœºä¸€å€¼ã€‚</p> <p>å‡å¦‚æˆ‘ä»¬ä½¿ç”¨å®šæ—¶ä»»åŠ¡åŠŸèƒ½ï¼Œåƒæˆ‘ä¸Šè¾¹æåˆ°çš„ï¼Œç®¡ç†äº†å¤§é‡çš„æœºå™¨ï¼Œé‚£ä¹ˆå¦‚æœåœ¨åŒä¸€æ—¶é—´çªç„¶æ‰¹é‡çš„æœºå™¨æ‰§è¡Œä»»åŠ¡ï¼ŒåŠ¿å¿…ä¼šäº§ç”Ÿè´Ÿè½½ä¸å‡è¡¡çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥è¿™æ ·å†™ï¼š<code>H 02 * * *</code>è¡¨ç¤ºå‡Œæ™¨ä¸¤ç‚¹çš„ä¸€ä¸ªå°æ—¶ä¸­ï¼Œéšæœºçš„ä¸€ä¸ªæ—¶é—´ç‚¹æ‰§è¡Œä»»åŠ¡ã€‚</p></li> <li><p>åŒæ—¶è¿˜å¯ä»¥ç”¨ä¸€äº›åˆ«åæ¥ç®€åŒ–æ“ä½œã€‚</p> <ul><li><code>@yearly</code>ï¼šæ¯å¹´æ‰§è¡Œä¸€æ¬¡</li> <li><code>@monthly</code>ï¼šæ¯æœˆæ‰§è¡Œä¸€æ¬¡</li> <li><code>@weekly</code>ï¼šæ¯å‘¨æ‰§è¡Œä¸€æ¬¡</li> <li><code>@daily</code>ï¼šæ¯å¤©æ‰§è¡Œä¸€æ¬¡</li> <li><code>@midnight</code>ï¼šä»£è¡¨åŠå¤œ12ç‚¹åˆ°å‡Œæ™¨2:59ä¹‹é—´çš„æŸä¸ªæ—¶é—´ã€‚</li> <li><code>@hourly</code>ï¼šæ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡</li></ul></li></ul> <h4 id="_2-pollscm"><a href="#_2-pollscm" class="header-anchor">#</a> 2ï¼ŒpollSCM</h4> <p>è¡¨ç¤ºå®šæœŸå¯¹ä»£ç ä»“åº“è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœæœ‰å˜åŒ–ï¼Œåˆ™è‡ªåŠ¨è§¦å‘æ„å»ºã€‚æˆ‘æ€ç´¢å†ä¸‰ï¼Œæ²¡æœ‰æƒ³åˆ°è¿™ç§ç­–ç•¥åœ¨å®é™…ç”Ÿäº§ä¸­çš„åº”ç”¨åœºæ™¯ï¼Œæ•…æ­¤ä¸åšè¿‡å¤šä»‹ç»ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    triggers <span class="token punctuation">{</span>
        <span class="token function">pollSCM</span><span class="token punctuation">(</span><span class="token string">'* * * * *'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'cronjob test'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'æ¯åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡ä»£ç ä»“åº“çš„å˜åŒ–'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="_3-upstream"><a href="#_3-upstream" class="header-anchor">#</a> 3ï¼Œupstream</h4> <p>å½“Bé¡¹ç›®çš„æ‰§è¡Œä¾èµ–Aé¡¹ç›®çš„æ‰§è¡Œç»“æœæ˜¯ï¼ŒAå°±æ˜¯Bçš„ä¸Šæ¸¸é¡¹ç›®ï¼Œåœ¨Jenkins2.22ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥é€šè¿‡upstreamå…³é”®å­—è¿›è¡Œè¿™ç§å…³ç³»çš„è¡¨ç¤ºã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>triggers <span class="token punctuation">{</span> 
		<span class="token comment">// job1,job2éƒ½æ˜¯ä»»åŠ¡åç§°</span>
		<span class="token function">upstream</span><span class="token punctuation">(</span>upstreamProjects<span class="token punctuation">:</span> <span class="token string">'job1,job2'</span><span class="token punctuation">,</span> threshold<span class="token punctuation">:</span> hudson<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Result<span class="token punctuation">.</span>SUCCESS<span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>hudson.model.Result</code>æ˜¯ä¸€ä¸ªæšä¸¾ç”¨äºæŒ‡ç¤ºä¸Šæ¸¸é¡¹ç›®çŠ¶æ€ï¼ŒåŒ…å«ä»¥ä¸‹æŒ‡ä»¤ï¼š</p> <ul><li>ABORTEDï¼šä»»åŠ¡è¢«æ‰‹åŠ¨ç»ˆæ­¢ã€‚</li> <li>FAILUREï¼šæ„å»ºå¤±è´¥ã€‚</li> <li>SUCCESSï¼šæ„å»ºæˆåŠŸã€‚</li> <li>UNSTABLEï¼šå­˜åœ¨ä¸€äº›é”™è¯¯ï¼Œä½†ä¸è‡³äºæ„å»ºå¤±è´¥ã€‚</li> <li>NOT_BUILTï¼šå†å¤šé˜¶æ®µæ„å»ºæ—¶ï¼Œå‰é¢é˜¶æ®µçš„é—®é¢˜å¯¼è‡´åé¢é˜¶æ®µæ— æ³•æ‰§è¡Œã€‚</li></ul> <h4 id="_4-gitlabäº‹ä»¶è§¦å‘ã€‚"><a href="#_4-gitlabäº‹ä»¶è§¦å‘ã€‚" class="header-anchor">#</a> 4ï¼Œgitlabäº‹ä»¶è§¦å‘ã€‚</h4> <p>è¿™ä¸ªæ‰æ˜¯çœŸæ­£æ›´å¤šåº”ç”¨åœºæ™¯çš„ï¼Œå¤§å¤šæ—¶å€™ï¼Œæˆ‘ä»¬éƒ½é»˜è®¤å°†é¡¹ç›®é…ç½®ä¸ºï¼Œå¼€å‘è€…æäº¤æŸäº›åˆ†æ”¯ï¼Œç„¶åè‡ªåŠ¨è§¦å‘å¯¹åº”çš„æ„å»ºã€‚ä¼ ç»Ÿæ–¹å¼ä¸‹ï¼Œéœ€è¦æ¯”è¾ƒå¤æ‚çš„å‡ æ­¥é…ç½®ï¼Œä½†æ˜¯åœ¨pipelineä¸­ä¹Ÿå¯ä»¥é€šè¿‡ä»£ç å½¢å¼å¯¹è¿™ç§è§¦å‘å™¨è¿›è¡Œé…ç½®ï¼Œå®åœ¨æ˜¯ä¸€å¤§ä¾¿åˆ©ç¥å™¨ã€‚</p> <p>åˆ°è¿™å„¿ï¼ŒåŸºæœ¬ä¸Šæ¯ä¸ªé¡¹ç›®åœ¨Jenkinså½“ä¸­çš„è€¦åˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¶Šæ¥è¶Šå°‘äº†ï¼Œæˆ‘ä»¬è¿ç»´äººå‘˜ï¼Œåªéœ€ä¸“æ³¨ç»´æŠ¤ <code>Jenkinsfile</code>ï¼Œç„¶ååˆ›å»ºå¯¹åº”é¡¹ç›®ï¼Œåªéœ€åœ¨æµæ°´çº¿å¤„é…ç½®ä»£ç urlå³å¯ã€‚</p> <p>è¿™é‡Œå…ˆç®€å•åšä¸€ä¸‹ç¤ºä¾‹ä»‹ç»ï¼Œå¹¶ä¸å±•å¼€ï¼Œåè¾¹ä¹Ÿä¼šä¸“é—¨å†™ç¯‡æ–‡ç« æ¥ä»‹ç»è¿™ç§åº”ç”¨æ–¹å¼ï¼Œæ³¨æ„ï¼Œgitlabè§¦å‘Jenkinsçš„æ„å»ºéœ€è¦ä¾èµ–<code>Gitlabæ’ä»¶</code>ï¼Œè€Œå¹¶ä¸éœ€è¦æ’ä»¶å½“ä¸­åˆ—å‡ºæ¥çš„æ‰€è°“çš„gitlab hookã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    triggers<span class="token punctuation">{</span>
        <span class="token function">gitlab</span><span class="token punctuation">(</span> triggerOnPush<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                triggerOnMergeRequest<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                branchFilterType<span class="token punctuation">:</span> <span class="token string">'All'</span><span class="token punctuation">,</span>
                secretToken<span class="token punctuation">:</span> <span class="token string gstring">&quot;028d848ab64f&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'æäº¤è§¦å‘çš„æ„å»º'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å¯¹äºè§¦å‘å™¨æ‰€ç”¨åˆ°çš„å‚æ•°ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ï¼š</p> <ul><li><p>triggerOnPushï¼šå½“Gitlabè§¦å‘pushäº‹ä»¶æ—¶ï¼Œæ˜¯å¦æ‰§è¡Œæ„å»ºã€‚</p></li> <li><p>triggerOnMergeRequestï¼šå½“Gitlabè§¦å‘mergeRequestäº‹ä»¶æ—¶ï¼Œæ˜¯å¦æ‰§è¡Œæ„å»ºã€‚</p></li> <li><p>branchFilterTypeï¼šåªæœ‰ç¬¦åˆæ¡ä»¶çš„åˆ†æ”¯æ‰ä¼šè§¦å‘æ„å»ºï¼Œå¿…é€‰ï¼Œå¦åˆ™æ— æ³•å®ç°è§¦å‘ã€‚</p> <p>å¯é€‰å‚æ•°æœ‰ï¼š</p> <ul><li>Allï¼šæ‰€æœ‰åˆ†æ”¯ã€‚</li> <li>NameBasedFilterï¼šåŸºäºåˆ†æ”¯åè¿›è¡Œè¿‡æ»¤ï¼Œå¤šä¸ªåˆ†æ”¯åä½¿ç”¨é€—å·åˆ†éš”ã€‚
<ul><li>includeBranchesSpecï¼šåŸºäºbranchFilterTypeå€¼ï¼Œè¾“å…¥æœŸæœ›åŒ…æ‹¬çš„åˆ†æ”¯çš„è§„åˆ™ã€‚</li> <li>excludeBranchesSpecï¼šåŸºäºbranchFilterTypeå€¼ï¼Œè¾“å…¥æœŸæœ›æ’é™¤çš„åˆ†æ”¯çš„è§„åˆ™ã€‚</li></ul></li> <li>RegexBasedFilterï¼šåŸºäºæ­£åˆ™è¡¨è¾¾å¼å¯¹åˆ†æ”¯åè¿›è¡Œè¿‡æ»¤ã€‚
<ul><li>sourceBranchRegexï¼šå®šä¹‰æœŸæœ›çš„é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼é™åˆ¶çš„åˆ†æ”¯è§„åˆ™ã€‚</li></ul></li></ul> <p>æ‰€æœ‰åˆ†æ”¯è¿™ä¸ªé€‰é¡¹ä¸ç”¨è§£é‡Šäº†ï¼Œå…¶ä½™ä¸¤ä¸ªé€‰é¡¹æ€ä¹ˆç”¨ï¼Œæ‰æ˜¯æ¯”è¾ƒé‡è¦ï¼Œè€Œä¸”å¯èƒ½åœ¨å®é™…ç”Ÿäº§ä¸­ï¼Œç»å¸¸æˆ–è€…ä¸€å®šä¼šç”¨åˆ°çš„ã€‚ä½†æ˜¯ç½‘ä¸Šçš„æ–‡ç« ï¼Œä¹ƒè‡³äºJenkinsçš„å®˜æ–¹æ–‡æ¡£ï¼Œä¹Ÿéƒ½åªæ˜¯åƒä¸Šè¾¹é‚£æ ·ï¼Œæåˆ°äº†æœ‰è¿™æ ·çš„è¯­æ³•è§„åˆ™å­˜åœ¨ï¼Œå¹¶æ²¡æœ‰ä»»ä½•ä¸€ä¸ªåœ°æ–¹ç»™å‡ºç¤ºä¾‹çš„ï¼Œå½“æˆ‘å»åˆ°Gitlabæ’ä»¶çš„å®˜æ–¹åœ°å€åï¼Œå‘ç°äº†ä¸‹è¾¹ç¬¬ä¸€ç§è¯­æ³•çš„ç®€å•ç¤ºä¾‹ï¼Œä»æ—§æ²¡æœ‰æˆ‘æƒ³è¦çš„åŸºäºæ­£åˆ™é™åˆ¶çš„é‚£ç§ï¼Œäºæ˜¯ï¼Œå„ä½æ³¨æ„ï¼Œçœ‹åˆ°è¿™ä¸ªåœ°æ–¹çš„ï¼Œéƒ½æ˜¯ç¼˜åˆ†ï¼Œä¹Ÿæ˜¯ç¦æ°”ï¼Œå› ä¸ºæœéå…¨ç½‘ä¹Ÿæ²¡æœ‰çš„ç¤ºä¾‹ï¼Œé¦–æ¬¡äº®ç›¸ï¼Œå°±æ˜¯åœ¨è¿™é‡Œã€‚</p> <ul><li>å¦‚æœåªæ¥å—å›ºå®šåˆ†æ”¯çš„è§¦å‘è¯·æ±‚ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</li></ul> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>	triggers<span class="token punctuation">{</span>
        <span class="token function">gitlab</span><span class="token punctuation">(</span> triggerOnPush<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                triggerOnMergeRequest<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
								branchFilterType<span class="token punctuation">:</span> <span class="token string gstring">&quot;NameBasedFilter&quot;</span><span class="token punctuation">,</span>
                includeBranchesSpec<span class="token punctuation">:</span> <span class="token string gstring">&quot;release&quot;</span><span class="token punctuation">,</span>
                secretToken<span class="token punctuation">:</span> <span class="token string gstring">&quot;<span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>env<span class="token punctuation">.</span>git_token<span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>å¦‚æœæƒ³é€šè¿‡æ­£åˆ™åŒ¹é…åˆ°æŸäº›åˆ†æ”¯è¿›è¡Œè§¦å‘ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</li></ul> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>	triggers<span class="token punctuation">{</span>
        <span class="token function">gitlab</span><span class="token punctuation">(</span> triggerOnPush<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                triggerOnMergeRequest<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
								branchFilterType<span class="token punctuation">:</span> <span class="token string gstring">&quot;RegexBasedFilter&quot;</span><span class="token punctuation">,</span>
                sourceBranchRegex<span class="token punctuation">:</span> <span class="token string gstring">&quot;test.*&quot;</span><span class="token punctuation">,</span>
                secretToken<span class="token punctuation">:</span> <span class="token string gstring">&quot;<span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>env<span class="token punctuation">.</span>git_token<span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <p><code>æ³¨æ„ï¼š</code>æ‰€æœ‰è§¦å‘å™¨åŒæ ·éƒ½éœ€è¦å…ˆæ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡ï¼Œè®©JenkinsåŠ è½½å…¶ä¸­çš„é…ç½®ï¼Œå¯¹åº”çš„æŒ‡ä»¤æ‰ä¼šç”Ÿæ•ˆã€‚</p> <h3 id="_8-parallel"><a href="#_8-parallel" class="header-anchor">#</a> 8ï¼Œparallel</h3> <p>parallelå…³é”®å­—ç”¨äºæŒ‡å®šæŸäº›é˜¶æ®µå¯ä»¥å¹¶è¡Œçš„æƒ…å†µï¼Œå½“ç„¶ï¼Œæµæ°´çº¿çš„æƒ…å†µä¸‹ï¼Œå¤§æ¦‚ç‡éƒ½æ˜¯ä¸²è¡Œçš„åœºæ™¯ï¼Œä¹Ÿæ­£ç¬¦åˆæ‰€è°“æµæ°´ç®¡é“çš„å®šä¹‰ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹å¹¶è¡Œçš„ç”¨æ³•ï¼Œå¹¶ä¸å±•å¼€è¿‡å¤šè®²è§£ã€‚</p> <p>å£°æ˜å¼æµæ°´çº¿çš„é˜¶æ®µå¯ä»¥åœ¨ä»–ä»¬å†…éƒ¨å£°æ˜å¤šéš”åµŒå¥—é˜¶æ®µ, å®ƒä»¬å°†å¹¶è¡Œæ‰§è¡Œã€‚ æ³¨æ„ï¼Œä¸€ä¸ªé˜¶æ®µå¿…é¡»åªæœ‰ä¸€ä¸ª <code>steps</code> æˆ– <code>parallel</code> çš„é˜¶æ®µã€‚ åµŒå¥—é˜¶æ®µæœ¬èº«ä¸èƒ½åŒ…å«è¿›ä¸€æ­¥çš„ <code>parallel</code> é˜¶æ®µ, ä½†æ˜¯å…¶ä»–çš„é˜¶æ®µçš„è¡Œä¸ºä¸ä»»ä½•å…¶ä»– <code>stage</code> ç›¸åŒã€‚ä»»ä½•åŒ…å« <code>parallel</code> çš„é˜¶æ®µä¸èƒ½åŒ…å« <code>agent</code> æˆ– <code>tools</code> é˜¶æ®µ, å› ä¸ºä»–ä»¬æ²¡æœ‰ç›¸å…³ <code>steps</code>ã€‚</p> <p>å¦å¤–, é€šè¿‡æ·»åŠ  <code>failFast true</code> åˆ°åŒ…å« <code>parallel</code>çš„ <code>stage</code> ä¸­ï¼Œ å½“å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹å¤±è´¥æ—¶ï¼Œä½ å¯ä»¥å¼ºåˆ¶æ‰€æœ‰çš„ <code>parallel</code> é˜¶æ®µéƒ½è¢«ç»ˆæ­¢ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any	
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Non-Parallel Stage'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'This stage will be executed first.'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Parallel Stage'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            failFast <span class="token boolean">true</span>
            parallel <span class="token punctuation">{</span>
                <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'å¹¶è¡Œä¸€'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    steps <span class="token punctuation">{</span>
                        echo <span class="token string gstring">&quot;å¹¶è¡Œä¸€&quot;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'å¹¶è¡ŒäºŒ'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    steps <span class="token punctuation">{</span>
                        echo <span class="token string gstring">&quot;å¹¶è¡ŒäºŒ&quot;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'å¹¶è¡Œä¸‰'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    stages <span class="token punctuation">{</span>
                        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Nested 1'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            steps <span class="token punctuation">{</span>
                                echo <span class="token string gstring">&quot;In stage Nested 1 within Branch C&quot;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Nested 2'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            steps <span class="token punctuation">{</span>
                                echo <span class="token string gstring">&quot;In stage Nested 2 within Branch C&quot;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="_3-å…¶ä»–å‚æ•°"><a href="#_3-å…¶ä»–å‚æ•°" class="header-anchor">#</a> 3ï¼Œå…¶ä»–å‚æ•°</h2> <h3 id="_1-sh"><a href="#_1-sh" class="header-anchor">#</a> 1ï¼Œsh</h3> <p>å½“æˆ‘ä»¬éœ€è¦æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æ­¤å…³é”®å­—å¼•å…¥ã€‚ç®€å•ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    when <span class="token punctuation">{</span>
        branch <span class="token string">'test'</span>
    <span class="token punctuation">}</span>
    steps<span class="token punctuation">{</span>
        sh <span class="token string">'rsync -avz --progress -e '</span>ssh <span class="token operator">-</span>p <span class="token number">22</span><span class="token string">' --exclude='</span>Jenkinsfile<span class="token string">' --exclude='</span><span class="token punctuation">.</span>git<span class="token string">' --delete ${WORKSPACE}/  root@$remote_ip:$remote_dir'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒ'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    when <span class="token punctuation">{</span>
        branch <span class="token string">'master'</span>
    <span class="token punctuation">}</span>
    steps <span class="token punctuation">{</span>
        sh <span class="token string">'''
            echo &quot;å¼€å§‹éƒ¨ç½²&quot;
            rsync -avz --progress -e 'ssh -p 22' --exclude='Jenkinsfile' --exclude='.git' --delete ${WORKSPACE}/  root@192.168.3.61:$remote_dir
        '''</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_2-deletedir"><a href="#_2-deletedir" class="header-anchor">#</a> 2ï¼ŒdeleteDir</h3> <p>è¡¨ç¤ºåˆ é™¤å½“å‰ç›®å½•ï¼Œé€šå¸¸ç”¨åœ¨æ„å»ºå®Œæ¯•ä¹‹åæ¸…ç©ºå·¥ä½œç©ºé—´ï¼Œæˆ–è€…ç»“åˆdirå…³é”®å­—ä½¿ç”¨ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'delete'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    steps <span class="token punctuation">{</span>
        echo <span class="token string">'æ¸…ç†å·¥ä½œç›®å½•'</span>
        <span class="token function">deleteDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å¦å¤–è¿˜æœ‰ä¸€ä¸ªcleanï¼ˆæ­¤æ–¹æ³•ä¾èµ–äºæ’ä»¶ <code>Workspace Cleanup</code>ï¼‰æ¸…ç†å·¥ä½œç©ºé—´æ—¶ç”¨æ³•ä¸ä¹‹ç±»ä¼¼ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'delete'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    steps <span class="token punctuation">{</span>
        echo <span class="token string">'æ¸…ç†å·¥ä½œç›®å½•'</span>
        <span class="token function">cleanWs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>åŒºåˆ«åœ¨äºdeleteDirå¯ä»¥æŒ‡å®šç›®å½•åˆ é™¤ã€‚</p> <h3 id="_3-dirã€‚"><a href="#_3-dirã€‚" class="header-anchor">#</a> 3ï¼Œdirã€‚</h3> <p>åˆ‡æ¢ç›®å½•ï¼Œé»˜è®¤æµæ°´çº¿å·¥ä½œä¸­å·¥ä½œç©ºé—´ç›®å½•ä¸­ï¼Œä½¿ç”¨dirå¯ä»¥è¿›è¡Œç›®å½•çš„åˆ‡æ¢ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token function">dir</span><span class="token punctuation">(</span><span class="token string gstring">&quot;/var/logs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">deleteDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_4-fileexists"><a href="#_4-fileexists" class="header-anchor">#</a> 4ï¼ŒfileExists</h3> <p>åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚å¯ç”¨ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œç›¸å¯¹è·¯å¾„çš„æ—¶å€™ï¼Œè®°ä½æ˜¯åŸºäº <code>$WORKSPACE</code>çš„ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    environment <span class="token punctuation">{</span>
        git_url     <span class="token operator">=</span> <span class="token string gstring">&quot;git@192.168.3.65:jenkins-learn/hello-world.git&quot;</span>
        remote_ip   <span class="token operator">=</span> <span class="token string gstring">&quot;192.168.3.67&quot;</span>
        remote_dir  <span class="token operator">=</span> <span class="token string gstring">&quot;/opt/hello&quot;</span>
    <span class="token punctuation">}</span>
    options <span class="token punctuation">{</span>
        <span class="token function">buildDiscarder</span><span class="token punctuation">(</span><span class="token function">logRotator</span><span class="token punctuation">(</span>numToKeepStr<span class="token punctuation">:</span> <span class="token string">'10'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">disableConcurrentBuilds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'rsync'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                script <span class="token punctuation">{</span>
                    build_file <span class="token operator">=</span> <span class="token string gstring">&quot;<span class="token expression"><span class="token punctuation">$</span>WORKSPACE</span>/README.md&quot;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fileExists</span><span class="token punctuation">(</span>build_file<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    sh <span class="token string">'''
                        rsync -avz --progress -e 'ssh -p 22' --exclude='Jenkinsfile' --exclude='.git' --delete ${WORKSPACE}/  root@$remote_ip:$remote_dir
                    '''</span>
                    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                        <span class="token function">error</span><span class="token punctuation">(</span><span class="token string gstring">&quot;here haven't find json file&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'delete'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'æ¸…ç†å·¥ä½œç›®å½•'</span>
                <span class="token function">cleanWs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    post <span class="token punctuation">{</span>
        success <span class="token punctuation">{</span>
            sh <span class="token string gstring">&quot;echo æˆåŠŸäº†&quot;</span>
        <span class="token punctuation">}</span>
        failure <span class="token punctuation">{</span>
            sh <span class="token string gstring">&quot;echo å¤±è´¥äº†&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>è¿™ä¸ªä¾‹å­æ¯”è¾ƒé€‚åˆç”Ÿäº§å½“ä¸­çš„æƒ…å¢ƒï¼Œéƒ¨ç½²çš„æ­¥éª¤æ”¾åœ¨ç¼–è¯‘çš„åè¾¹ï¼Œå¦‚æœç¼–è¯‘ä¹‹åï¼ŒJavaé¡¹ç›®çš„waråŒ…æ²¡æœ‰ç”Ÿæˆï¼Œé‚£ä¹ˆæˆ‘ä»¬è·³å‡ºæ„å»ºï¼Œå¦‚æœç”Ÿæˆäº†ï¼Œåˆ™æ‰§è¡Œæ„å»ºçš„æ­¥éª¤ã€‚</p> <h3 id="_5-error"><a href="#_5-error" class="header-anchor">#</a> 5ï¼Œerror</h3> <p>ä¸»åŠ¨æŠ¥é”™ï¼Œç»ˆæ­¢å½“å‰æµæ°´çº¿ã€‚</p> <p>ä¸Šè¾¹å·²ç»å¼•ç”¨åˆ°äº†ï¼Œé€šå¸¸åœ¨å¸ƒå°”å‚æ•°ä¹‹åä¼šé€‰ç”¨ã€‚</p> <h3 id="_6-timeout"><a href="#_6-timeout" class="header-anchor">#</a> 6ï¼Œtimeout</h3> <p>ä»£ç å—è¶…æ—¶æ—¶é—´ã€‚é€šå¸¸è¿™åœ¨æ‰§è¡Œä¸€äº›ç¼–è¯‘æ­¥éª¤å¦‚é‡ä¸å¯çŸ¥æƒ…å†µå¯¼è‡´ç¼–è¯‘å¤±è´¥è€Œåˆä¸é€€å‡ºçš„æƒ…å†µã€‚</p> <p>timeoutæ”¯æŒå¦‚ä¸‹å‚æ•°ï¼š</p> <ul><li>timeï¼šæ•´å‹ï¼Œè¶…æ—¶æ—¶é—´ã€‚</li> <li>unitï¼šæ—¶é—´å•ä½ï¼Œæ”¯æŒçš„å€¼æœ‰NANOSECONDS,MICROSECONDS,MILLISECONDS,SECONDS,MINUTES(é»˜è®¤),HOURS,DAYS.</li> <li>activityï¼šå¸ƒå°”ç±»å‹ï¼Œå¦‚æœä¸ºtrueï¼Œåˆ™åªæœ‰å½“æ—¥å¿—æ²¡æœ‰æ´»åŠ¨ä¹‹åï¼Œæ‰çœŸæ­£ç®—è¶…æ—¶ã€‚</li></ul> <p>ç”¨æ³•ï¼Œç›´æ¥åœ¨å°†è¦æ‰§è¡Œçš„é˜¶æ®µä¹‹å¤–ï¼Œç”¨å…³é”®å­—åŒ…è£¹å³å¯ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		steps<span class="token punctuation">{</span>
        sh <span class="token string">'rsync -avz --progress -e '</span>ssh <span class="token operator">-</span>p <span class="token number">22</span><span class="token string">' --exclude='</span>Jenkinsfile<span class="token string">' --exclude='</span><span class="token punctuation">.</span>git<span class="token string">' --delete ${WORKSPACE}/  root@$remote_ip:$remote_dir'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_7-waitutil"><a href="#_7-waitutil" class="header-anchor">#</a> 7ï¼ŒwaitUtil</h3> <p>ç­‰å¾…æ¡ä»¶æ»¡è¶³ï¼Œä¸æ–­é‡å¤ä»£ç å—ä¸­çš„å†…å®¹ï¼Œç›´åˆ°æ¡ä»¶ä¸ºtrueã€‚è¿™ä¸ªåŠŸèƒ½çš„åº”ç”¨åœºæ™¯æˆ‘å€’æ˜¯æƒ³åˆ°äº†ä¸€ä¸ªï¼Œå¾ˆè´´åˆ‡ï¼Œæœ‰ä¸€äº›æœåŠ¡åœ¨ç”Ÿäº§ç¯å¢ƒè·‘ç€ï¼Œå¹¶ä¸èƒ½ç›´æ¥å…³é—­å‘å¸ƒï¼Œè€Œå¾€å¾€åŠ å…¥ä¸€ä¸ªä¼˜é›…åœæœºçš„åŠŸèƒ½ï¼Œå› æ­¤è°ƒç”¨åœæœºæ¥å£ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åšä¸€ä¸ªç­‰å¾…ï¼Œç­‰å¾…æœåŠ¡ç«¯å£å½»åº•å…³é—­ä¹‹åï¼Œå†è¿›è¡Œéƒ¨ç½²ï¼Œå½“ç„¶ï¼Œæœ€å¥½å†é…åˆä¸€ä¸‹timeoutï¼Œä»¥é¿å…æ­»å¾ªç¯ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    waitUntil<span class="token punctuation">{</span>
        script<span class="token punctuation">{</span>
            <span class="token keyword">def</span> r <span class="token operator">=</span> sh script<span class="token punctuation">:</span> <span class="token string">'curl http://exmaple'</span><span class="token punctuation">,</span>returnStatus<span class="token punctuation">:</span> <span class="token boolean">true</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span> r <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_8-retry"><a href="#_8-retry" class="header-anchor">#</a> 8ï¼Œretry</h3> <p>é‡å¤æ‰§è¡ŒæŸä¸ªå—ï¼Œå¦‚æœæŸæ¬¡æ‰§è¡Œä¸­æœ‰å¼‚å¸¸ï¼Œåˆ™è·³å‡ºå½“æ¬¡ï¼Œè€Œä¸ä¼šå½±å“æ•´ä½“ã€‚æ³¨æ„ï¼Œåœ¨æ‰§è¡Œretryè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·æ— æ³•æ‰‹åŠ¨ç»ˆæ­¢æµæ°´çº¿ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>steps <span class="token punctuation">{</span>
    <span class="token function">retry</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    script<span class="token punctuation">{</span>
        sh script<span class="token punctuation">:</span> <span class="token string">'curl http://exmaple'</span><span class="token punctuation">,</span>returnStatus<span class="token punctuation">:</span> <span class="token boolean">true</span>        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_9-sleep"><a href="#_9-sleep" class="header-anchor">#</a> 9ï¼Œsleep</h3> <p>è®©pipelineç¡çœ ä¸€æ®µæ—¶é—´ã€‚</p> <p>æ”¯æŒå‚æ•°å¦‚ä¸‹ï¼š</p> <ul><li>timeï¼šæ•´å‹ï¼Œä¼‘çœ æ—¶é—´ã€‚</li> <li>unitï¼šæ—¶é—´å•ä½ï¼Œæ”¯æŒçš„å€¼æœ‰NANOSECONDS,MICROSECONDS,MILLISECONDS,SECONDS(é»˜è®¤),MINUTES,HOURS,DAYS.</li></ul> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span> <span class="token comment">//ä¼‘çœ 120ç§’</span>
<span class="token function">sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>unit<span class="token punctuation">:</span> <span class="token string gstring">&quot;MINUTES&quot;</span><span class="token punctuation">)</span> <span class="token comment">//ä¼‘çœ 2åˆ†é’Ÿ</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_10-try-catch"><a href="#_10-try-catch" class="header-anchor">#</a> 10ï¼Œtry&amp;catch</h3> <p>å°½ç®¡æˆ‘éå¸¸æ¨å´‡æ—¥å¸¸æ„å»ºé‡‡ç”¨å£°æ˜å¼çš„å³å¯ï¼Œä½†æ˜¯æœ‰ä¸€äº›è„šæœ¬å¼ä¸­æ¯”è¾ƒä¸é”™çš„å‚æ•°ï¼Œä¹Ÿæ˜¯å€¼å¾—å­¦ä¹ ï¼Œè€Œä¸”å€¼å¾—è¿ç”¨çš„ã€‚è¿™ä¸ªtryä¸catchå°±æ˜¯ç±»ä¼¼çš„ä¸€ç§ã€‚</p> <p>æ—¥å¸¸æµæ°´çº¿æ„å»ºä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æ•´æ¡çº¿æ¯ä¸€é˜¶æ®µéƒ½æ˜¯æ­£å¸¸çš„ï¼Œä¸€æ—¦æœ‰å¼‚å¸¸çš„æƒ…å†µï¼Œå°±åº”è¯¥é€€å‡ºæ„å»ºã€‚æ¯”å¦‚æˆ‘ä»¬ä¸åº”è¯¥åœ¨ç¼–è¯‘ä»£ç å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œè¿˜å»é‡å¯æœåŠ¡ï¼Œéƒ¨ç½²æœåŠ¡ï¼Œè¿™æ ·æå¯èƒ½ä¼šé€ æˆä¸€äº›ä¸å¯çŸ¥çš„é—®é¢˜ï¼Œä¸¥é‡çš„è¿˜å¯èƒ½å› ä¸ºæ„å»ºå¼•å‘æœåŠ¡é—®é¢˜ã€‚</p> <p>ç®€å•è¯´æ˜å°±æ˜¯ï¼Œæµæ°´çº¿ä¼šé¡ºè¡Œæ‰§è¡Œtryå…³é”®å­—å—å†…çš„è¯­å¥ï¼Œå¦‚æœæ‰€æœ‰è¯­å¥æ‰§è¡Œéƒ½æ­£å¸¸ï¼Œé‚£ä¹ˆç¨‹åºæ­£å¸¸é€€å‡ºï¼Œå¦‚æœæœ‰å¼‚å¸¸ï¼Œåˆ™catchéƒ¨åˆ†å°†ä¼šæ•æ‰é”™è¯¯ï¼Œè¿›è¡Œæ‰“å°ï¼Œå¹¶é€€å‡ºæ•´ä¸ªæµæ°´çº¿ï¼Œè¿™ä¸€ç‚¹éå¸¸å…³é”®ï¼ŒæŸä¸ªé˜¶æ®µæœ‰å¼‚å¸¸ï¼Œæ•´ä¸ªæ„å»ºç»“æŸï¼Œè¿™ä¸€ç‰¹æ€§ï¼Œå€¼å¾—æ¨å¹¿åˆ°æ‰€æœ‰çš„æµæ°´çº¿å½“ä¸­åº”ç”¨èµ·æ¥ã€‚</p> <p>ç®€å•ç¤ºä¾‹ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline<span class="token punctuation">{</span>
    agent any
    stages<span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Example1'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                script <span class="token punctuation">{</span>
                    <span class="token keyword">try</span> <span class="token punctuation">{</span>
                        echo <span class="token string">'aaa'</span>
                        eccho <span class="token string">'bbb'</span>
                        echo <span class="token string">'ccc'</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        echo <span class="token string">'err'</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>       
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Example2'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                script <span class="token punctuation">{</span>
                    <span class="token keyword">try</span> <span class="token punctuation">{</span>
                        echo <span class="token string">'aaa'</span>
                        echo <span class="token string">'ccc'</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        echo <span class="token string">'err'</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>       
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    post<span class="token punctuation">{</span>
        always<span class="token punctuation">{</span>
            echo <span class="token string gstring">&quot;========always========&quot;</span>
        <span class="token punctuation">}</span>
        success<span class="token punctuation">{</span>
            echo <span class="token string gstring">&quot;========pipeline executed successfully ========&quot;</span>
        <span class="token punctuation">}</span>
        failure<span class="token punctuation">{</span>
            echo <span class="token string gstring">&quot;========pipeline execution failed========&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>å°†ä»£ç æ”¾åˆ°pipelineå½“ä¸­ï¼Œæ‰§è¡Œä»¥ä¸‹ï¼Œå¯ä»¥çœ‹ä¸‹æ„å»ºæ—¥å¿—ï¼š</p> <p><img src="http://tvax4.sinaimg.cn/large/71cfeb93ly1gmavsqoswaj20iu0c50uc.jpg" alt="img"></p> <p>å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºé˜¶æ®µ1ä¸­æœ‰å¼‚å¸¸ï¼Œå¯¼è‡´ç¨‹åºé€€å‡ºï¼Œé˜¶æ®µ2ä¹Ÿæ²¡æœ‰æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨æœ€åæŠ›å‡ºäº†å¼‚å¸¸çš„å†…å®¹ã€‚</p> <h3 id="_11-docker"><a href="#_11-docker" class="header-anchor">#</a> 11ï¼Œdocker</h3> <p>åœ¨æµæ°´çº¿ä¸­ä½¿ç”¨dockerï¼Œèƒ½å¤Ÿæ–¹ä¾¿æˆ‘ä»¬å¯¹ä¸€äº›ç¯å¢ƒè¿›è¡Œéš”ç¦»ï¼Œä»¥åŠä¸€äº›ä¼˜ç§€è¯­æ³•çš„åº”ç”¨ä½¿å¾—æ„å»ºæ›´åŠ ä¼˜é›…ã€‚</p> <p>ä¸Šè¾¹agentè°ƒç”¨dockerå·²ç»ä»‹ç»äº†ï¼Œè¿™é‡Œç€é‡å†è¯´æ˜ä¸€ä¸‹æ‰“é•œåƒçš„æ“ä½œã€‚</p> <h4 id="_1-æ„å»ºå®¹å™¨"><a href="#_1-æ„å»ºå®¹å™¨" class="header-anchor">#</a> 1ï¼Œæ„å»ºå®¹å™¨</h4> <p>ä¸ºäº†æ„å»º Docker é•œåƒ,<a href="https://plugins.jenkins.io/docker-workflow" target="_blank" rel="noopener noreferrer">Docker æµæ°´çº¿<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ’ä»¶ä¹Ÿæä¾›äº†ä¸€ä¸ª <code>build()</code> æ–¹æ³•ç”¨äºåœ¨æµæ°´çº¿è¿è¡ŒæœŸé—´ä»å­˜å‚¨åº“çš„<code>Dockerfile</code> ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚</p> <p>ä½¿ç”¨è¯­æ³• <code>docker.build(&quot;my-image-name&quot;)</code> çš„ä¸»è¦å¥½å¤„æ˜¯ï¼Œ è„šæœ¬åŒ–çš„æµæ°´çº¿èƒ½å¤Ÿä½¿ç”¨åç»­ Dockeræµæ°´çº¿è°ƒç”¨çš„è¿”å›å€¼, æ¯”å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>node <span class="token punctuation">{</span>
    checkout scm
    <span class="token keyword">def</span> customImage <span class="token operator">=</span> docker<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string gstring">&quot;my-image:<span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>env<span class="token punctuation">.</span>BUILD_ID<span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span>
    customImage<span class="token punctuation">.</span>inside <span class="token punctuation">{</span>
        sh <span class="token string">'make test'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>è¯¥è¿”å›å€¼ä¹Ÿå¯ä»¥ç”¨äºé€šè¿‡ <code>push()</code> æ–¹æ³•å°†Docker é•œåƒå‘å¸ƒåˆ° <a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, æˆ– <a href="https://www.jenkins.io/zh/doc/book/pipeline/docker/#custom-registry" target="_blank" rel="noopener noreferrer">custom Registry<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>,æ¯”å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>node <span class="token punctuation">{</span>
    checkout scm
    <span class="token keyword">def</span> customImage <span class="token operator">=</span> docker<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string gstring">&quot;my-image:<span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>env<span class="token punctuation">.</span>BUILD_ID<span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span>
    customImage<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>é•œåƒ &quot;tags&quot;çš„ä¸€ä¸ªå¸¸è§ç”¨æ³•æ˜¯ ä¸ºæœ€è¿‘çš„, éªŒè¯è¿‡çš„, Dockeré•œåƒçš„ç‰ˆæœ¬ï¼ŒæŒ‡å®š <code>latest</code> æ ‡ç­¾ã€‚ <code>push()</code> æ–¹æ³•æ¥å—å¯é€‰çš„ <code>tag</code> å‚æ•°, å…è®¸æµæ°´çº¿ä½¿ç”¨ä¸åŒçš„æ ‡ç­¾ push <code>customImage</code> , æ¯”å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>node <span class="token punctuation">{</span>
    checkout scm
    <span class="token keyword">def</span> customImage <span class="token operator">=</span> docker<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string gstring">&quot;my-image:<span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>env<span class="token punctuation">.</span>BUILD_ID<span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span>
    customImage<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    customImage<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'latest'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ <code>build()</code> æ–¹æ³•åœ¨å½“å‰ç›®å½•æ„å»ºä¸€ä¸ª <code>Dockerfile</code>ã€‚æä¾›ä¸€ä¸ªåŒ…å« <code>Dockerfile</code>æ–‡ä»¶çš„ç›®å½•è·¯å¾„ä½œä¸º<code>build()</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•° å°±å¯ä»¥è¦†ç›–è¯¥æ–¹æ³•, æ¯”å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>node <span class="token punctuation">{</span>
    checkout scm
    <span class="token keyword">def</span> testImage <span class="token operator">=</span> docker<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string gstring">&quot;test-image&quot;</span><span class="token punctuation">,</span> <span class="token string gstring">&quot;./dockerfiles/test&quot;</span><span class="token punctuation">)</span> 

    testImage<span class="token punctuation">.</span>inside <span class="token punctuation">{</span>
        sh <span class="token string">'make test'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä»åœ¨ <code>./dockerfiles/test/Dockerfile</code>ä¸­å‘ç°çš„Dockerfileä¸­æ„å»º<code>test-image</code>ã€‚</p> <p>é€šè¿‡æ·»åŠ å…¶ä»–å‚æ•°åˆ° <code>build()</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­ï¼Œä¼ é€’å®ƒä»¬åˆ° <a href="https://docs.docker.com/engine/reference/commandline/build/" target="_blank" rel="noopener noreferrer">docker build<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚ å½“ä½¿ç”¨è¿™ç§æ–¹æ³•ä¼ é€’å‚æ•°æ—¶, è¯¥å­—ç¬¦ä¸²çš„æœ€åä¸€ä¸ªå€¼å¿…é¡»æ˜¯Dockeræ–‡ä»¶çš„è·¯å¾„ã€‚</p> <p>è¯¥ç¤ºä¾‹é€šè¿‡ä¼ é€’ <code>-f</code>æ ‡å¿—è¦†ç›–äº†é»˜è®¤çš„ <code>Dockerfile</code> :</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>node <span class="token punctuation">{</span>
    checkout scm
    <span class="token keyword">def</span> dockerfile <span class="token operator">=</span> <span class="token string">'Dockerfile.test'</span>
    <span class="token keyword">def</span> customImage <span class="token operator">=</span> docker<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string gstring">&quot;my-image:<span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>env<span class="token punctuation">.</span>BUILD_ID<span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">,</span> <span class="token string gstring">&quot;-f <span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>dockerfile<span class="token punctuation">}</span></span> ./dockerfiles&quot;</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ä»åœ¨<code>./dockerfiles/Dockerfile.test</code>å‘ç°çš„Dockerfileæ„å»º <code>my-image:${env.BUILD_ID}</code>ã€‚</p> <h4 id="_2-ä½¿ç”¨è‡ªå®šä¹‰æ³¨å†Œè¡¨"><a href="#_2-ä½¿ç”¨è‡ªå®šä¹‰æ³¨å†Œè¡¨" class="header-anchor">#</a> 2ï¼Œä½¿ç”¨è‡ªå®šä¹‰æ³¨å†Œè¡¨</h4> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ <a href="https://plugins.jenkins.io/docker-workflow" target="_blank" rel="noopener noreferrer">Docker æµæ°´çº¿<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é›†æˆäº† <a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>é»˜è®¤çš„ Dockeræ³¨å†Œè¡¨ã€‚ .</p> <p>ä¸ºäº†ä½¿ç”¨è‡ªå®šä¹‰Docker æ³¨å†Œå§, è„šæœ¬åŒ–æµæ°´çº¿çš„ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨ <code>withRegistry()</code> æ–¹æ³•å®Œæˆæ­¥éª¤ï¼Œä¼ å…¥è‡ªå®šä¹‰æ³¨å†Œè¡¨çš„URL, æ¯”å¦‚:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>node <span class="token punctuation">{</span>
    checkout scm

    docker<span class="token punctuation">.</span><span class="token function">withRegistry</span><span class="token punctuation">(</span><span class="token string">'https://registry.example.com'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        docker<span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token string">'my-custom-image'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>inside <span class="token punctuation">{</span>
            sh <span class="token string">'make test'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å¯¹äºéœ€è¦èº«ä»½éªŒè¯çš„Docker æ³¨å†Œè¡¨, ä»Jenkins ä¸»é¡µæ·»åŠ ä¸€ä¸ª &quot;Username/Password&quot; è¯ä¹¦é¡¹ï¼Œ å¹¶ä½¿ç”¨è¯ä¹¦ID ä½œä¸º <code>withRegistry()</code>çš„ç¬¬äºŒä¸ªå‚æ•°:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>node <span class="token punctuation">{</span>
    checkout scm

    docker<span class="token punctuation">.</span><span class="token function">withRegistry</span><span class="token punctuation">(</span><span class="token string">'https://registry.example.com'</span><span class="token punctuation">,</span> <span class="token string">'credentials-id'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">def</span> customImage <span class="token operator">=</span> docker<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string gstring">&quot;my-image:<span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>env<span class="token punctuation">.</span>BUILD_ID<span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span>

        <span class="token comment">/* Push the container to the custom Registry */</span>
        customImage<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_3-è¿è¡Œ-sidecar-å®¹å™¨"><a href="#_3-è¿è¡Œ-sidecar-å®¹å™¨" class="header-anchor">#</a> 3ï¼Œè¿è¡Œ &quot;sidecar&quot; å®¹å™¨</h4> <p>åœ¨æµæ°´çº¿ä¸­ä½¿ç”¨Dockerå¯èƒ½æ˜¯è¿è¡Œæ„å»ºæˆ–ä¸€ç»„æµ‹è¯•çš„æ‰€ä¾èµ–çš„æœåŠ¡çš„æœ‰æ•ˆæ–¹æ³•ã€‚ç±»ä¼¼äº <a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/sidecar" target="_blank" rel="noopener noreferrer">sidecar æ¨¡å¼<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Docker æµæ°´çº¿å¯ä»¥&quot;åœ¨åå°&quot;è¿è¡Œä¸€ä¸ªå®¹å™¨ , è€Œåœ¨å¦å¤–ä¸€ä¸ªå®¹å™¨ä¸­å·¥ä½œã€‚ åˆ©ç”¨è¿™ç§sidecar æ–¹å¼, æµæ°´çº¿å¯ä»¥ä¸ºæ¯ä¸ªæµæ°´çº¿è¿è¡Œ æä¾›ä¸€ä¸ª&quot;å¹²å‡€çš„&quot; å®¹å™¨ã€‚</p> <p>è€ƒè™‘ä¸€ä¸ªå‡è®¾çš„é›†æˆæµ‹è¯•å¥—ä»¶ï¼Œå®ƒä¾èµ–äºæœ¬åœ° MySQL æ•°æ®åº“æ¥è¿è¡Œã€‚ä½¿ç”¨ <code>withRun</code> æ–¹æ³•, åœ¨ <a href="https://plugins.jenkins.io/docker-workflow" target="_blank" rel="noopener noreferrer">Docker Pipeline<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ’ä»¶ä¸­å®ç°å¯¹è„šæœ¬åŒ–æµæ°´çº¿çš„æ”¯æŒ, <code>Jenkinsfile</code> æ–‡ä»¶å¯ä»¥è¿è¡Œ MySQLä½œä¸ºsidecar :</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>node <span class="token punctuation">{</span>
    checkout scm
    <span class="token comment">/*
     * In order to communicate with the MySQL server, this Pipeline explicitly
     * maps the port (`3306`) to a known port on the host machine.
     */</span>
    docker<span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token string">'mysql:5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withRun</span><span class="token punctuation">(</span><span class="token string">'-e &quot;MYSQL_ROOT_PASSWORD=my-secret-pw&quot; -p 3306:3306'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> c <span class="token operator">-&gt;</span>
        <span class="token comment">/* Wait until mysql service is up */</span>
        sh <span class="token string">'while ! mysqladmin ping -h0.0.0.0 --silent; do sleep 1; done'</span>
        <span class="token comment">/* Run some tests which require MySQL */</span>
        sh <span class="token string">'make check'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>è¯¥ç¤ºä¾‹å¯ä»¥æ›´è¿›ä¸€æ­¥, åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªå®¹å™¨ã€‚ ä¸€ä¸ª &quot;sidecar&quot; è¿è¡Œ MySQL, å¦ä¸€ä¸ªæä¾›<a href="https://www.jenkins.io/zh/doc/book/pipeline/docker/#execution-environment" target="_blank" rel="noopener noreferrer">æ‰§è¡Œç¯å¢ƒ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, é€šè¿‡ä½¿ç”¨Docker <a href="https://docs.docker.com/engine/userguide/networking/default_network/dockerlinks/" target="_blank" rel="noopener noreferrer">å®¹å™¨é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>node <span class="token punctuation">{</span>
    checkout scm
    docker<span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token string">'mysql:5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withRun</span><span class="token punctuation">(</span><span class="token string">'-e &quot;MYSQL_ROOT_PASSWORD=my-secret-pw&quot;'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> c <span class="token operator">-&gt;</span>
        docker<span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token string">'mysql:5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inside</span><span class="token punctuation">(</span><span class="token string gstring">&quot;--link <span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>c<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>:db&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">/* Wait until mysql service is up */</span>
            sh <span class="token string">'while ! mysqladmin ping -hdb --silent; do sleep 1; done'</span>
        <span class="token punctuation">}</span>
        docker<span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token string">'centos:7'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inside</span><span class="token punctuation">(</span><span class="token string gstring">&quot;--link <span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>c<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>:db&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">/*
             * Run some tests which require MySQL, and assume that it is
             * available on the host name `db`
             */</span>
            sh <span class="token string">'make check'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>ä¸Šé¢çš„ç¤ºä¾‹ä½¿ç”¨ <code>withRun</code>å…¬å¼€çš„é¡¹ç›®, å®ƒé€šè¿‡ <code>id</code> å±æ€§å…·æœ‰å¯ç”¨çš„è¿è¡Œå®¹å™¨çš„IDã€‚ä½¿ç”¨è¯¥å®¹å™¨çš„ ID, æµæ°´çº¿é€šè¿‡è‡ªå®šä¹‰ Docker å‚æ•°ç”Ÿæˆä¸€ä¸ªåˆ°<code>inside()</code> æ–¹æ³•çš„é“¾ã€‚</p> <p>The <code>id</code> property can also be useful for inspecting logs from a running Docker container before the Pipeline exits:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>sh <span class="token string gstring">&quot;docker logs <span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span>c<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_12-withenv"><a href="#_12-withenv" class="header-anchor">#</a> 12ï¼ŒwithEnv</h3> <p>é»˜è®¤æƒ…å†µä¸‹å£°æ˜çš„ç¯å¢ƒå˜é‡çš„ç”Ÿæ•ˆæ—¶é—´éƒ½æ˜¯è´¯ç©¿æ•´ä¸ªæµæ°´çº¿å£°æ˜çš„ï¼Œå¦‚æœæƒ³è¦æ›´æ”¹ä¸€ä¸ªå˜é‡çš„å€¼ï¼Œåˆ™å¯ä»¥ç”¨ <code>withEnv</code>ä¸´æ—¶ä¿®æ”¹ï¼Œåœ¨åŒºå—ä¹‹å¤–å³æ¢å¤ï¼š</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
   agent any
   environment <span class="token punctuation">{</span>
       Name <span class="token operator">=</span> <span class="token string">'null'</span>
   <span class="token punctuation">}</span>

   stages   <span class="token punctuation">{</span>
      <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Stage 1'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        steps<span class="token punctuation">{</span>
            <span class="token function">catchError</span><span class="token punctuation">(</span>buildResult<span class="token punctuation">:</span> <span class="token string">'UNSTABLE'</span><span class="token punctuation">,</span> stageResult<span class="token punctuation">:</span> <span class="token string">'FAILURE'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
               script <span class="token punctuation">{</span>
                    echo env<span class="token punctuation">.</span>Test_Category_Name <span class="token comment">// è¾“å‡º null</span>
                    <span class="token function">withEnv</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string gstring">&quot;Name =Test&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                       echo env<span class="token punctuation">.</span>Test_Category_Name <span class="token comment">// è¾“å‡º Test</span>
                    <span class="token punctuation">}</span>
                    echo env<span class="token punctuation">.</span>Test_Category_Name <span class="token comment">// è¾“å‡º null</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>å‚è€ƒå†…å®¹ï¼š</p> <ul><li><a href="https://jenkins.io/zh/doc/book/pipeline/syntax/" target="_blank" rel="noopener noreferrer">Jenkinså®˜æ–¹æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>https://blog.csdn.net/u011541946</li> <li>Jenkins 2.xå®è·µæŒ‡å—</li></ul></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=jenkins" title="æ ‡ç­¾">#jenkins</a><a href="/tags/?tag=%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3" title="æ ‡ç­¾">#é…ç½®è¯¦è§£</a></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2021/07/03, 17:50:46</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/3292.html" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">pipelineç¬”è®°ä¹‹ä»ä¸€ä¸ªç®€å•çš„é¡¹ç›®æ„å»ºå¼€å§‹</div></a> <a href="/pages/3304.html" class="page-nav-centre page-nav-centre-next"><div class="tooltip">è‡ªåŠ¨æ„å»ºçš„åŸå§‹é…ç½®ä»¥åŠpipelineä¸­çš„ç”¨æ³•</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/3292.html" class="prev">pipelineç¬”è®°ä¹‹ä»ä¸€ä¸ªç®€å•çš„é¡¹ç›®æ„å»ºå¼€å§‹</a></span> <span class="next"><a href="/pages/3304.html">è‡ªåŠ¨æ„å»ºçš„åŸå§‹é…ç½®ä»¥åŠpipelineä¸­çš„ç”¨æ³•</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/5be3f4/"><div>å†è§WordPressï¼ŒHello Vuepress</div></a> <span>07-04</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/0477b6/"><div>æµç¨‹æ§åˆ¶</div></a> <span>07-06</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/3e84ca/"><div>è¿ç®—ç¬¦</div></a> <span>07-06</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:Linuxlql@163.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/eryajf" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/user/home?id=316286554" title="å¬éŸ³ä¹" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2017-2021
    <span>by Eryajf | <a rel="nofollow " target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=18057030">æµ™ICPå¤‡18057030å·</a> | <a href="https://github.com/eryajf/eryajf.github.io/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><canvas id="vuepress-canvas-cursor"></canvas><div></div></div></div>
    <script src="/assets/js/app.8ad1afb9.js" defer></script><script src="/assets/js/2.faffa19e.js" defer></script><script src="/assets/js/210.55c9cde7.js" defer></script>
  </body>
</html>